(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[241],{1504:function(e,t,r){Promise.resolve().then(r.bind(r,3511))},9376:function(e,t,r){"use strict";var n=r(5475);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},3511:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return V}});var n=r(7437),i=r(2265),o=r(9376),s=r(3954),a=r(419);let d=s.ZP.div.withConfig({componentId:"sc-dbdd9151-0"})(["height:100%;display:flex;flex-direction:column;background:var(--background-secondary);"]),l=s.ZP.div.withConfig({componentId:"sc-dbdd9151-1"})(["display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:var(--background-primary);border-bottom:1px solid var(--gray-5);"]),c=s.ZP.button.withConfig({componentId:"sc-dbdd9151-2"})(["background:none;border:none;color:var(--primary-blue);font-size:16px;font-weight:500;cursor:pointer;padding:8px 0;&:hover{opacity:0.7;}"]),u=s.ZP.h1.withConfig({componentId:"sc-dbdd9151-3"})(["font-size:18px;font-weight:600;color:var(--text-primary);margin:0;"]),g=s.ZP.div.withConfig({componentId:"sc-dbdd9151-4"})(["width:60px;"]),h=s.ZP.div.withConfig({componentId:"sc-dbdd9151-5"})(["flex:1;overflow-y:auto;padding:20px;@media (min-width:769px){padding:30px;}"]),p=s.ZP.div.withConfig({componentId:"sc-dbdd9151-6"})(["background:var(--background-primary);border-radius:var(--border-radius-large);padding:20px;margin-bottom:24px;box-shadow:var(--shadow-small);border:1px solid var(--gray-6);@media (min-width:769px){padding:24px;margin-bottom:32px;}"]),m=s.ZP.div.withConfig({componentId:"sc-dbdd9151-7"})(["display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;"]),f=s.ZP.button.withConfig({componentId:"sc-dbdd9151-8"})(["background:none;border:none;color:var(--primary-blue);font-size:24px;font-weight:600;cursor:pointer;padding:8px;border-radius:var(--border-radius-small);width:40px;height:40px;display:flex;align-items:center;justify-content:center;&:hover{background:rgba(0,122,255,0.1);}&:active{transform:scale(0.95);}"]),x=s.ZP.h2.withConfig({componentId:"sc-dbdd9151-9"})(["font-size:20px;font-weight:600;color:var(--text-primary);margin:0;"]),b=s.ZP.div.withConfig({componentId:"sc-dbdd9151-10"})(["width:100%;"]),w=s.ZP.div.withConfig({componentId:"sc-dbdd9151-11"})(["display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:8px;"]),v=s.ZP.div.withConfig({componentId:"sc-dbdd9151-12"})(["text-align:center;font-size:12px;font-weight:600;color:var(--text-secondary);padding:8px 4px;"]),y=s.ZP.div.withConfig({componentId:"sc-dbdd9151-13"})(["display:grid;grid-template-columns:repeat(7,1fr);gap:4px;"]),S=s.ZP.button.withConfig({componentId:"sc-dbdd9151-14"})(["aspect-ratio:1;background:",";color:",";border:1px solid ",";border-radius:var(--border-radius-small);font-size:14px;font-weight:",";cursor:pointer;transition:var(--transition-fast);display:flex;align-items:center;justify-content:center;position:relative;min-height:40px;&:hover:not(:disabled){background:",";}&:active:not(:disabled){transform:scale(0.95);}&:disabled{cursor:default;opacity:0.5;}"],e=>e.isToday?"var(--primary-blue)":e.hasSession?"var(--primary-green)":e.isOtherMonth?"transparent":"var(--background-secondary)",e=>e.isToday||e.hasSession?"white":e.isOtherMonth?"var(--text-tertiary)":"var(--text-primary)",e=>e.isOtherMonth?"transparent":"var(--gray-5)",e=>e.isToday?"700":"500",e=>e.isToday?"#0056CC":e.hasSession?"#2DB653":"var(--gray-5)"),C=s.ZP.div.withConfig({componentId:"sc-dbdd9151-15"})(["position:absolute;bottom:2px;right:2px;width:6px;height:6px;background:var(--primary-orange);border-radius:50%;border:1px solid white;"]),P=s.ZP.div.withConfig({componentId:"sc-dbdd9151-16"})(["background:var(--background-primary);border-radius:var(--border-radius-large);padding:20px;box-shadow:var(--shadow-small);border:1px solid var(--gray-6);@media (min-width:769px){padding:24px;}"]),j=s.ZP.h3.withConfig({componentId:"sc-dbdd9151-17"})(["font-size:18px;font-weight:600;color:var(--text-primary);margin:0 0 16px 0;"]),k=s.ZP.div.withConfig({componentId:"sc-dbdd9151-18"})(["display:flex;flex-direction:column;gap:12px;"]),I=s.ZP.div.withConfig({componentId:"sc-dbdd9151-19"})(["display:flex;justify-content:space-between;align-items:center;padding:16px;background:var(--background-secondary);border-radius:var(--border-radius-medium);border:1px solid var(--gray-6);"]),D=s.ZP.div.withConfig({componentId:"sc-dbdd9151-20"})(["display:flex;flex-direction:column;gap:4px;"]),Z=s.ZP.div.withConfig({componentId:"sc-dbdd9151-21"})(["font-size:16px;font-weight:600;color:var(--text-primary);"]),M=s.ZP.div.withConfig({componentId:"sc-dbdd9151-22"})(["font-size:14px;color:var(--text-secondary);"]),T=s.ZP.div.withConfig({componentId:"sc-dbdd9151-23"})(["font-size:14px;font-weight:600;color:var(--primary-blue);"]),E=s.ZP.div.withConfig({componentId:"sc-dbdd9151-24"})(["padding:4px 8px;border-radius:var(--border-radius-small);font-size:12px;font-weight:600;text-transform:uppercase;",""],e=>"completed"===e.status?"\n        background: rgba(52, 199, 89, 0.1);\n        color: var(--primary-green);\n      ":"stopped"===e.status?"\n        background: rgba(255, 59, 48, 0.1);\n        color: var(--primary-red);\n      ":"\n      background: rgba(142, 142, 147, 0.1);\n      color: var(--text-secondary);\n    "),U=s.ZP.div.withConfig({componentId:"sc-dbdd9151-25"})(["text-align:center;padding:40px 20px;color:var(--text-secondary);font-size:16px;"]),z=["January","February","March","April","May","June","July","August","September","October","November","December"],O=["SUN","MON","TUE","WED","THU","FRI","SAT"];function V(){let e=(0,o.useRouter)(),{currentUser:t,getUserSessions:r}=(0,a.a)(),[s,V]=(0,i.useState)(new Date),[A,N]=(0,i.useState)(null),[_,F]=(0,i.useState)([]);(0,i.useEffect)(()=>{t&&F(r())},[t,r]);let R=(0,i.useMemo)(()=>{let e=s.getFullYear(),t=s.getMonth(),r=new Date(e,t,1),n=new Date(r);n.setDate(n.getDate()-r.getDay());let i=[],o=new Date(n);o.setDate(o.getDate()+42);for(let e=new Date(n);e<o;e.setDate(e.getDate()+1)){let r=e.toISOString().split("T")[0],n=_.filter(e=>e.startTime&&e.startTime.startsWith(r));i.push({date:new Date(e),dateString:r,isCurrentMonth:e.getMonth()===t,isToday:r===new Date().toISOString().split("T")[0],hasSession:n.length>0,sessions:n})}return i},[s,_]),L=(0,i.useMemo)(()=>{if(A)return _.filter(e=>e.startTime&&e.startTime.startsWith(A));let e=s.getFullYear(),t=s.getMonth(),r="".concat(e,"-").concat((t+1).toString().padStart(2,"0"));return _.filter(e=>e.startTime&&e.startTime.startsWith(r))},[_,A,s]),W=e=>{e.isCurrentMonth&&N(e.dateString)},Y=e=>e?new Date(e).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):"",J=e=>{switch(e){case"completed":return"completed";case"stopped":return"stopped";default:return"scheduled"}},B="".concat(z[s.getMonth()]," ").concat(s.getFullYear());return(0,n.jsxs)(d,{children:[(0,n.jsxs)(l,{children:[(0,n.jsx)(c,{onClick:()=>{e.push("/main")},children:"← 뒤로"}),(0,n.jsx)(u,{children:"월별 기록"}),(0,n.jsx)(g,{})]}),(0,n.jsxs)(h,{children:[(0,n.jsxs)(p,{children:[(0,n.jsxs)(m,{children:[(0,n.jsx)(f,{onClick:()=>{V(e=>new Date(e.getFullYear(),e.getMonth()-1,1)),N(null)},children:"‹"}),(0,n.jsx)(x,{children:B}),(0,n.jsx)(f,{onClick:()=>{V(e=>new Date(e.getFullYear(),e.getMonth()+1,1)),N(null)},children:"›"})]}),(0,n.jsxs)(b,{children:[(0,n.jsx)(w,{children:O.map(e=>(0,n.jsx)(v,{children:e},e))}),(0,n.jsx)(y,{children:R.map((e,t)=>(0,n.jsxs)(S,{isCurrentMonth:e.isCurrentMonth,isToday:e.isToday,hasSession:e.hasSession,isOtherMonth:!e.isCurrentMonth,onClick:()=>W(e),disabled:!e.isCurrentMonth,children:[e.date.getDate(),e.hasSession&&(0,n.jsx)(C,{})]},t))})]})]}),(0,n.jsxs)(P,{children:[(0,n.jsx)(j,{children:A?"".concat(new Date(A).toLocaleDateString("ko-KR")," 세션"):"".concat(z[s.getMonth()]," 세션")}),(0,n.jsx)(k,{children:L.length>0?L.map((e,t)=>(0,n.jsxs)(I,{children:[(0,n.jsxs)(D,{children:[(0,n.jsx)(Z,{children:e.title||"뽀모도로 세션"}),(0,n.jsxs)(M,{children:[e.goal&&"목표: ".concat(e.goal),e.duration&&" • ".concat(e.duration,"분"),e.tags&&" • ".concat(e.tags)]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(T,{children:Y(e.startTime)}),(0,n.jsxs)(E,{status:J(e.status),children:["completed"===e.status&&"완료","stopped"===e.status&&"중단","scheduled"===e.status&&"예정"]})]})]},e.id||t)):(0,n.jsx)(U,{children:A?"선택한 날짜에 세션이 없습니다.":"이번 달에 진행한 세션이 없습니다."})})]})]})]})}},419:function(e,t,r){"use strict";r.d(t,{UserProvider:function(){return c},a:function(){return l}});var n=r(5583),i=r(1780),o=r(7437),s=r(2265),a=r(81);let d=(0,s.createContext)(),l=()=>{let e=(0,s.useContext)(d);if(!e)throw Error("useUser must be used within a UserProvider");return e},c=e=>{let{children:t}=e,[r,l]=(0,s.useState)(null),[c]=(0,s.useState)(()=>new a.w),[u,g]=(0,s.useState)(null),[h,p]=(0,s.useState)(null),[m,f]=(0,s.useState)(!1),[x,b]=(0,s.useState)(!0),[w,v]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{let e=c.getCurrentSession();if(e){let t=c.getUser(e.userId);t?(l(t),p(e.token),f(!0),P(e.userId)):c.logoutSession()}}catch(e){console.error("Error initializing auth:",e),c.logoutSession()}finally{b(!1)}})();let e=setInterval(()=>{if(h){let e=c.validateSession(h);if(e){let t=new Date(e.expiresAt),r=new Date,n=t.getTime()-r.getTime();n>0&&n<=3e5&&!e.rememberMe?v("세션이 ".concat(Math.ceil(n/6e4),"분 후 만료됩니다.")):v(null)}else v("세션이 만료되어 자동으로 로그아웃됩니다."),setTimeout(()=>C(),3e3)}},3e4);return()=>clearInterval(e)},[c,h]);let y=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{if(b(!0),v(null),!(null==e?void 0:e.trim()))throw Error("사용자명을 입력해주세요.");if(!t)throw Error("비밀번호를 입력해주세요.");let n=await c.loginUser(e.trim(),t,r);return l(n.user),p(n.sessionToken),f(!0),P(n.user.id),n.user}catch(e){if(console.error("Login failed:",e),e.message.includes("존재하지 않는"))throw Error("존재하지 않는 사용자입니다. 사용자명을 확인해주세요.");if(e.message.includes("비밀번호가 올바르지"))throw e;if(e.message.includes("일시적으로 잠겼습니다"))throw e;throw Error("로그인에 실패했습니다. 사용자명과 비밀번호를 확인해주세요.")}finally{b(!1)}},S=async(e,t)=>{try{var r;if(b(!0),v(null),!(null==e?void 0:e.trim()))throw Error("사용자명을 입력해주세요.");if(!(null==t?void 0:null===(r=t.email)||void 0===r?void 0:r.trim()))throw Error("이메일을 입력해주세요.");if(!(null==t?void 0:t.password))throw Error("비밀번호를 입력해주세요.");return await c.registerUser(e.trim(),(0,i._)((0,n._)({},t),{email:t.email.trim()}))}catch(e){if(console.error("Registration failed:",e),e.message.includes("이미 존재하는"))throw Error("이미 사용 중인 사용자명입니다. 다른 사용자명을 선택해주세요.");if(e.message.includes("이미 사용 중인 이메일"))throw Error("이미 사용 중인 이메일 주소입니다. 다른 이메일을 사용해주세요.");if(e.message.includes("비밀번호"))throw e;if(e.message.includes("이메일"))throw e;else if(e.message.includes("사용자명"))throw e;else throw Error("회원가입에 실패했습니다. 입력 정보를 확인하고 다시 시도해주세요.")}finally{b(!1)}},C=()=>{try{c.logoutSession(h),l(null),g(null),p(null),f(!1),v(null)}catch(e){console.error("Logout error:",e),l(null),g(null),p(null),f(!1),v(null)}},P=e=>{let t=c.getActiveSession(e);t&&(new Date<new Date(t.endTime)?g(t):(c.clearActiveSession(e),g(null)))},j=async e=>{if(!r)throw Error("No user logged in");try{let t=await c.updateUserProfile(r.id,e);return l(t),t}catch(e){throw console.error("Profile update failed:",e),e}};return(0,o.jsx)(d.Provider,{value:{currentUser:r,activeSession:u,sessionToken:h,isSessionValid:m,authLoading:x,sessionWarning:w,loginUser:y,registerUser:S,logoutUser:C,createPomodoroSession:e=>{if(!r)throw Error("No user logged in");let t=c.createPomodoroSession(r.id,e);return g(t),t},completePomodoroSession:()=>{r&&u&&(c.completePomodoroSession(r.id,u.id),g(null))},stopPomodoroSession:()=>{r&&u&&(c.stopPomodoroSession(r.id,u.id),g(null))},getUserStats:()=>r?c.getUserStats(r.id):null,getUserSessions:()=>r?c.getUserSessions(r.id):[],updateUserProfile:j,getUserActivity:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return r?c.getUserActivity(r.id,e):null},validateCurrentSession:()=>!!h&&(!!c.validateSession(h)||(C(),!1)),checkPasswordStrength:e=>{if(!e)return{isValid:!1,errors:["비밀번호를 입력해주세요"],warnings:[],score:0,strength:"weak"};let t=[];e.length<4&&t.push("비밀번호는 4자 이상이어야 합니다");let r=Math.min(10*e.length,100),n={medium:r>=50&&r<80,strong:r>=80};return{isValid:0===t.length,errors:t,warnings:[],score:r,strength:n.strong?"strong":n.medium?"medium":"weak"}},validateEmail:e=>{if(!e||"string"!=typeof e)return{isValid:!1,error:"이메일을 입력해주세요."};let t=e.trim().toLowerCase();return t.includes("@")?{isValid:!0,normalizedEmail:t}:{isValid:!1,error:"이메일에 @가 포함되어야 합니다."}},validateUsername:e=>{if(!e||"string"!=typeof e)return{isValid:!1,error:"사용자명을 입력해주세요."};let t=e.trim();return t.length<1?{isValid:!1,error:"사용자명을 입력해주세요."}:t.length>50?{isValid:!1,error:"사용자명은 50자 이하여야 합니다."}:{isValid:!0,normalizedUsername:t.toLowerCase()}},extendSession:()=>!!(h&&c.validateSession(h))&&(v(null),!0),dismissSessionWarning:()=>{v(null)},userManager:c},children:t})}}},function(e){e.O(0,[954,81,971,966,744],function(){return e(e.s=1504)}),_N_E=e.O()}]);