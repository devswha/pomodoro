(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[129],{4622:function(e,r,o){Promise.resolve().then(o.bind(o,8769))},9376:function(e,r,o){"use strict";var n=o(5475);o.o(n,"usePathname")&&o.d(r,{usePathname:function(){return n.usePathname}}),o.o(n,"useRouter")&&o.d(r,{useRouter:function(){return n.useRouter}})},8769:function(e,r,o){"use strict";o.r(r),o.d(r,{default:function(){return k}});var n=o(5583),i=o(1780),t=o(7437),s=o(2265),a=o(9376),l=o(3954),d=o(419);let c=l.ZP.div.withConfig({componentId:"sc-e2bb6e63-0"})(["height:100%;display:flex;flex-direction:column;background:#ffffff;position:relative;@media (min-width:769px){justify-content:center;align-items:center;min-height:100vh;background:#f8f9fa;}"]),m=l.ZP.button.withConfig({componentId:"sc-e2bb6e63-1"})(["position:absolute;top:1rem;left:1.5rem;background:none;border:none;color:#000000;font-size:1rem;font-weight:500;cursor:pointer;padding:0.5rem;z-index:100;&:hover{opacity:0.7;}@media (min-width:769px){top:2rem;left:2rem;}"]),u=l.ZP.div.withConfig({componentId:"sc-e2bb6e63-2"})(["flex:1;padding:4rem 2rem 2rem;display:flex;flex-direction:column;justify-content:center;@media (min-width:769px){max-width:450px;width:100%;padding:3rem;background:#ffffff;border:1px solid #e9ecef;flex:none;}@media (min-width:1200px){max-width:500px;padding:4rem;}"]),f=l.ZP.div.withConfig({componentId:"sc-e2bb6e63-3"})(["margin-bottom:3rem;text-align:center;"]),h=l.ZP.h1.withConfig({componentId:"sc-e2bb6e63-4"})(["font-size:2rem;font-weight:600;color:#000000;margin-bottom:0.5rem;@media (min-width:769px){font-size:2.5rem;}"]),g=l.ZP.p.withConfig({componentId:"sc-e2bb6e63-5"})(["font-size:1rem;color:#6c757d;margin:0;"]),p=l.ZP.form.withConfig({componentId:"sc-e2bb6e63-6"})(["display:flex;flex-direction:column;gap:1.5rem;"]),w=l.ZP.div.withConfig({componentId:"sc-e2bb6e63-7"})(["display:flex;flex-direction:column;gap:0.5rem;"]),b=l.ZP.label.withConfig({componentId:"sc-e2bb6e63-8"})(["font-size:0.875rem;font-weight:500;color:#000000;text-transform:uppercase;letter-spacing:0.05em;"]),x=l.ZP.input.withConfig({componentId:"sc-e2bb6e63-9"})(["width:100%;padding:1rem;border:2px solid ",";border-radius:0;font-size:1rem;color:#000000;background:#ffffff;transition:border-color 0.2s ease;&:focus{outline:none;border-color:#000000;}&::placeholder{color:#adb5bd;}"],e=>e.error?"#dc3545":"#e9ecef"),v=l.ZP.div.withConfig({componentId:"sc-e2bb6e63-10"})(["color:#dc3545;font-size:0.875rem;margin-top:0.25rem;opacity:",";transition:opacity 0.2s ease;"],e=>e.show?1:0),P=l.ZP.button.withConfig({componentId:"sc-e2bb6e63-11"})(["width:100%;padding:1rem;background:#000000;color:#ffffff;border:none;border-radius:0;font-size:1rem;font-weight:600;text-transform:uppercase;letter-spacing:0.05em;cursor:pointer;transition:all 0.2s ease;margin-top:1rem;&:hover:not(:disabled){background:#333333;}&:disabled{background:#adb5bd;cursor:not-allowed;}"]),j=l.ZP.div.withConfig({componentId:"sc-e2bb6e63-12"})(["text-align:center;margin-top:2rem;color:#6c757d;font-size:0.875rem;button{background:none;border:none;color:#000000;text-decoration:underline;cursor:pointer;font-size:inherit;&:hover{opacity:0.7;}}"]),y=l.ZP.div.withConfig({componentId:"sc-e2bb6e63-13"})(["width:1rem;height:1rem;border:2px solid #ffffff;border-top:2px solid transparent;border-radius:50%;animation:spin 1s linear infinite;margin-right:0.5rem;display:inline-block;@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}"]),S=l.ZP.div.withConfig({componentId:"sc-e2bb6e63-14"})(["margin-top:0.5rem;display:flex;flex-direction:column;gap:0.25rem;.strength-bar{height:4px;background:#e9ecef;border-radius:2px;overflow:hidden;.strength-fill{height:100%;transition:all 0.3s ease;&.weak{width:33%;background:#dc3545;}&.medium{width:66%;background:#ffc107;}&.strong{width:100%;background:#28a745;}}}.strength-text{font-size:0.75rem;color:#6c757d;&.weak{color:#dc3545;}&.medium{color:#ffc107;}&.strong{color:#28a745;}}"]),C=l.ZP.ul.withConfig({componentId:"sc-e2bb6e63-15"})(["margin:0.5rem 0 0 0;padding:0;list-style:none;font-size:0.75rem;color:#6c757d;li{display:flex;align-items:center;gap:0.5rem;margin-bottom:0.25rem;&.valid{color:#28a745;}&.invalid{color:#dc3545;}&::before{content:'•';width:0.75rem;text-align:center;}&.valid::before{content:'✓';color:#28a745;}&.invalid::before{content:'✗';color:#dc3545;}}"]);function k(){let e=(0,a.useRouter)(),{registerUser:r,currentUser:o,authLoading:l,checkPasswordStrength:k,validateEmail:_,validateUsername:E,userManager:z}=(0,d.a)(),[U,I]=(0,s.useState)({username:"",email:"",password:"",confirmPassword:""}),[Z,V]=(0,s.useState)({}),[N,T]=(0,s.useState)(!1),[A,D]=(0,s.useState)(null),[L,R]=(0,s.useState)(!1),[q,M]=(0,s.useState)(!1),[O,W]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{!l&&o&&e.push("/main")},[o,l,e]),l)return(0,t.jsx)(c,{children:(0,t.jsx)(u,{children:(0,t.jsxs)("div",{style:{textAlign:"center",padding:"2rem"},children:[(0,t.jsx)(y,{}),"Loading..."]})})});let B=async()=>{let e={},r=E(U.username);r.isValid?z.isUsernameUnique(r.normalizedUsername)||(e.username="이미 사용 중인 사용자명입니다."):e.username=r.error;let o=_(U.email);if(o.isValid?z.isEmailUnique(o.normalizedEmail)||(e.email="이미 사용 중인 이메일 주소입니다."):e.email=o.error,U.password){let r=k(U.password);r.isValid||(e.password="비밀번호가 요구사항을 충족하지 않습니다: "+r.errors.join(", "))}else e.password="비밀번호를 입력해주세요.";return U.confirmPassword?U.password!==U.confirmPassword&&(e.confirmPassword="비밀번호가 일치하지 않습니다."):e.confirmPassword="비밀번호 확인을 입력해주세요.",V(e),0===Object.keys(e).length},F=(e,r)=>{let o=(0,i._)((0,n._)({},U),{[e]:r});I(o),Z[e]&&V(r=>(0,i._)((0,n._)({},r),{[e]:""})),"password"===e&&(r?(D(k(r)),R(!0)):(D(null),R(!1)),o.confirmPassword&&r!==o.confirmPassword?V(e=>(0,i._)((0,n._)({},e),{confirmPassword:"비밀번호가 일치하지 않습니다."})):o.confirmPassword&&r===o.confirmPassword&&V(e=>(0,i._)((0,n._)({},e),{confirmPassword:""}))),"username"===e&&r&&(M(!0),setTimeout(()=>{let e=E(r);e.isValid?z.isUsernameUnique(e.normalizedUsername)||V(e=>(0,i._)((0,n._)({},e),{username:"이미 사용 중인 사용자명입니다."})):r.length>=1&&V(r=>(0,i._)((0,n._)({},r),{username:e.error})),M(!1)},500)),"email"===e&&r&&(W(!0),setTimeout(()=>{let e=_(r);e.isValid?z.isEmailUnique(e.normalizedEmail)||V(e=>(0,i._)((0,n._)({},e),{email:"이미 사용 중인 이메일 주소입니다."})):r.includes("@")&&V(r=>(0,i._)((0,n._)({},r),{email:e.error})),W(!1)},500)),"confirmPassword"===e&&(r&&o.password&&r!==o.password?V(e=>(0,i._)((0,n._)({},e),{confirmPassword:"비밀번호가 일치하지 않습니다."})):r&&o.password&&r===o.password&&V(e=>(0,i._)((0,n._)({},e),{confirmPassword:""})))},G=async o=>{if(o.preventDefault(),await B()){T(!0);try{await r(U.username.trim(),{displayName:U.username.trim(),email:U.email.trim(),password:U.password}),alert("회원가입이 완료되었습니다! 로그인해주세요."),e.push("/login")}catch(e){V({general:e.message||"회원가입에 실패했습니다. 다시 시도해주세요."})}finally{T(!1)}}};return(0,t.jsxs)(c,{children:[(0,t.jsx)(m,{onClick:()=>{e.push("/login")},children:"← 뒤로"}),(0,t.jsxs)(u,{children:[(0,t.jsxs)(f,{children:[(0,t.jsx)(h,{children:"회원가입"}),(0,t.jsx)(g,{children:"새 계정을 만들어보세요"})]}),(0,t.jsxs)(p,{onSubmit:G,children:[(0,t.jsxs)(w,{children:[(0,t.jsx)(b,{children:"사용자명"}),(0,t.jsx)(x,{type:"text",placeholder:"사용자명 입력 (4-20자, 영문/숫자/_)",value:U.username,onChange:e=>F("username",e.target.value),error:Z.username,autoComplete:"username"}),q&&(0,t.jsx)("div",{style:{fontSize:"0.75rem",color:"#6c757d",marginTop:"0.25rem"},children:"사용자명 확인 중..."}),(0,t.jsx)(v,{show:!!Z.username,children:Z.username})]}),(0,t.jsxs)(w,{children:[(0,t.jsx)(b,{children:"이메일"}),(0,t.jsx)(x,{type:"email",placeholder:"이메일 주소 입력",value:U.email,onChange:e=>F("email",e.target.value),error:Z.email,autoComplete:"email"}),O&&(0,t.jsx)("div",{style:{fontSize:"0.75rem",color:"#6c757d",marginTop:"0.25rem"},children:"이메일 확인 중..."}),(0,t.jsx)(v,{show:!!Z.email,children:Z.email})]}),(0,t.jsxs)(w,{children:[(0,t.jsx)(b,{children:"비밀번호"}),(0,t.jsx)(x,{type:"password",placeholder:"비밀번호 입력 (4자 이상)",value:U.password,onChange:e=>F("password",e.target.value),error:Z.password,autoComplete:"new-password"}),A&&(0,t.jsxs)(S,{children:[(0,t.jsx)("div",{className:"strength-bar",children:(0,t.jsx)("div",{className:"strength-fill ".concat(A.strength)})}),(0,t.jsxs)("div",{className:"strength-text ".concat(A.strength),children:["weak"===A.strength&&"비밀번호 강도: 약함","medium"===A.strength&&"비밀번호 강도: 보통","strong"===A.strength&&"비밀번호 강도: 강함"]})]}),L&&A&&(0,t.jsx)(C,{children:(0,t.jsx)("li",{className:U.password.length>=4?"valid":"invalid",children:"4자 이상"})}),A&&A.warnings&&A.warnings.length>0&&(0,t.jsx)("div",{style:{fontSize:"0.75rem",color:"#ffc107",marginTop:"0.5rem"},children:A.warnings.map((e,r)=>(0,t.jsxs)("div",{children:["⚠️ ",e]},r))}),(0,t.jsx)(v,{show:!!Z.password,children:Z.password})]}),(0,t.jsxs)(w,{children:[(0,t.jsx)(b,{children:"비밀번호 확인"}),(0,t.jsx)(x,{type:"password",placeholder:"비밀번호 다시 입력",value:U.confirmPassword,onChange:e=>F("confirmPassword",e.target.value),error:Z.confirmPassword,autoComplete:"new-password"}),(0,t.jsx)(v,{show:!!Z.confirmPassword,children:Z.confirmPassword})]}),Z.general&&(0,t.jsx)(v,{show:!0,children:Z.general}),(0,t.jsxs)(P,{type:"submit",disabled:N,children:[N&&(0,t.jsx)(y,{}),N?"가입 중...":"회원가입"]})]}),(0,t.jsxs)(j,{children:["이미 계정이 있나요?"," ",(0,t.jsx)("button",{type:"button",onClick:()=>{e.push("/login")},children:"로그인"})]})]})]})}},419:function(e,r,o){"use strict";o.d(r,{UserProvider:function(){return c},a:function(){return d}});var n=o(5583),i=o(1780),t=o(7437),s=o(2265),a=o(81);let l=(0,s.createContext)(),d=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useUser must be used within a UserProvider");return e},c=e=>{let{children:r}=e,[o,d]=(0,s.useState)(null),[c]=(0,s.useState)(()=>new a.w),[m,u]=(0,s.useState)(null),[f,h]=(0,s.useState)(null),[g,p]=(0,s.useState)(!1),[w,b]=(0,s.useState)(!0),[x,v]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{let e=c.getCurrentSession();if(e){let r=c.getUser(e.userId);r?(d(r),h(e.token),p(!0),S(e.userId)):c.logoutSession()}}catch(e){console.error("Error initializing auth:",e),c.logoutSession()}finally{b(!1)}})();let e=setInterval(()=>{if(f){let e=c.validateSession(f);if(e){let r=new Date(e.expiresAt),o=new Date,n=r.getTime()-o.getTime();n>0&&n<=3e5&&!e.rememberMe?v("세션이 ".concat(Math.ceil(n/6e4),"분 후 만료됩니다.")):v(null)}else v("세션이 만료되어 자동으로 로그아웃됩니다."),setTimeout(()=>y(),3e3)}},3e4);return()=>clearInterval(e)},[c,f]);let P=async function(e,r){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{if(b(!0),v(null),!(null==e?void 0:e.trim()))throw Error("사용자명을 입력해주세요.");if(!r)throw Error("비밀번호를 입력해주세요.");let n=await c.loginUser(e.trim(),r,o);return d(n.user),h(n.sessionToken),p(!0),S(n.user.id),n.user}catch(e){if(console.error("Login failed:",e),e.message.includes("존재하지 않는"))throw Error("존재하지 않는 사용자입니다. 사용자명을 확인해주세요.");if(e.message.includes("비밀번호가 올바르지"))throw e;if(e.message.includes("일시적으로 잠겼습니다"))throw e;throw Error("로그인에 실패했습니다. 사용자명과 비밀번호를 확인해주세요.")}finally{b(!1)}},j=async(e,r)=>{try{var o;if(b(!0),v(null),!(null==e?void 0:e.trim()))throw Error("사용자명을 입력해주세요.");if(!(null==r?void 0:null===(o=r.email)||void 0===o?void 0:o.trim()))throw Error("이메일을 입력해주세요.");if(!(null==r?void 0:r.password))throw Error("비밀번호를 입력해주세요.");return await c.registerUser(e.trim(),(0,i._)((0,n._)({},r),{email:r.email.trim()}))}catch(e){if(console.error("Registration failed:",e),e.message.includes("이미 존재하는"))throw Error("이미 사용 중인 사용자명입니다. 다른 사용자명을 선택해주세요.");if(e.message.includes("이미 사용 중인 이메일"))throw Error("이미 사용 중인 이메일 주소입니다. 다른 이메일을 사용해주세요.");if(e.message.includes("비밀번호"))throw e;if(e.message.includes("이메일"))throw e;else if(e.message.includes("사용자명"))throw e;else throw Error("회원가입에 실패했습니다. 입력 정보를 확인하고 다시 시도해주세요.")}finally{b(!1)}},y=()=>{try{c.logoutSession(f),d(null),u(null),h(null),p(!1),v(null)}catch(e){console.error("Logout error:",e),d(null),u(null),h(null),p(!1),v(null)}},S=e=>{let r=c.getActiveSession(e);r&&(new Date<new Date(r.endTime)?u(r):(c.clearActiveSession(e),u(null)))},C=async e=>{if(!o)throw Error("No user logged in");try{let r=await c.updateUserProfile(o.id,e);return d(r),r}catch(e){throw console.error("Profile update failed:",e),e}};return(0,t.jsx)(l.Provider,{value:{currentUser:o,activeSession:m,sessionToken:f,isSessionValid:g,authLoading:w,sessionWarning:x,loginUser:P,registerUser:j,logoutUser:y,createPomodoroSession:e=>{if(!o)throw Error("No user logged in");let r=c.createPomodoroSession(o.id,e);return u(r),r},completePomodoroSession:()=>{o&&m&&(c.completePomodoroSession(o.id,m.id),u(null))},stopPomodoroSession:()=>{o&&m&&(c.stopPomodoroSession(o.id,m.id),u(null))},getUserStats:()=>o?c.getUserStats(o.id):null,getUserSessions:()=>o?c.getUserSessions(o.id):[],updateUserProfile:C,getUserActivity:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return o?c.getUserActivity(o.id,e):null},validateCurrentSession:()=>!!f&&(!!c.validateSession(f)||(y(),!1)),checkPasswordStrength:e=>{if(!e)return{isValid:!1,errors:["비밀번호를 입력해주세요"],warnings:[],score:0,strength:"weak"};let r=[];e.length<4&&r.push("비밀번호는 4자 이상이어야 합니다");let o=Math.min(10*e.length,100),n={medium:o>=50&&o<80,strong:o>=80};return{isValid:0===r.length,errors:r,warnings:[],score:o,strength:n.strong?"strong":n.medium?"medium":"weak"}},validateEmail:e=>{if(!e||"string"!=typeof e)return{isValid:!1,error:"이메일을 입력해주세요."};let r=e.trim().toLowerCase();return r.includes("@")?{isValid:!0,normalizedEmail:r}:{isValid:!1,error:"이메일에 @가 포함되어야 합니다."}},validateUsername:e=>{if(!e||"string"!=typeof e)return{isValid:!1,error:"사용자명을 입력해주세요."};let r=e.trim();return r.length<1?{isValid:!1,error:"사용자명을 입력해주세요."}:r.length>50?{isValid:!1,error:"사용자명은 50자 이하여야 합니다."}:{isValid:!0,normalizedUsername:r.toLowerCase()}},extendSession:()=>!!(f&&c.validateSession(f))&&(v(null),!0),dismissSessionWarning:()=>{v(null)},userManager:c},children:r})}}},function(e){e.O(0,[954,81,971,966,744],function(){return e(e.s=4622)}),_N_E=e.O()}]);