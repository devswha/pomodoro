exports.id=248,exports.ids=[248],exports.modules={6615:(e,t,s)=>{Promise.resolve().then(s.bind(s,1574)),Promise.resolve().then(s.bind(s,6887)),Promise.resolve().then(s.bind(s,3987))},2957:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},7272:()=>{},1574:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});var r=s(326),i=s(3500);let n=i.ZP.div.withConfig({componentId:"sc-be8e0932-0"})(["min-height:100vh;background:#ffffff;display:flex;justify-content:center;align-items:flex-start;padding:0;"]),o=i.ZP.div.withConfig({componentId:"sc-be8e0932-1"})(["width:100%;max-width:100%;min-height:100vh;background:#ffffff;position:relative;overflow:hidden;@media (min-width:769px){max-width:1200px;}@media (min-width:1200px){max-width:1400px;}"]);function a({children:e}){return r.jsx(n,{children:r.jsx(o,{children:e})})}},6887:(e,t,s)=>{"use strict";s.d(t,{RealtimeProvider:()=>u,r:()=>l});var r=s(326),i=s(7577),n=s(785),o=s(3987);let a=(0,i.createContext)(),l=()=>{let e=(0,i.useContext)(a);if(!e)throw Error("useRealtime must be used within a RealtimeProvider");return e},u=({children:e})=>{let{currentUser:t}=(0,o.a)(),[s,l]=(0,i.useState)(!1),[u,d]=(0,i.useState)("disconnected"),[c,m]=(0,i.useState)(new Map),[S,g]=(0,i.useState)({}),[h,p]=(0,i.useState)([]),[f,w]=(0,i.useState)([]),[y,v]=(0,i.useState)(navigator?.onLine??!0),[I,b]=(0,i.useState)(null),[O,E]=(0,i.useState)(null),[D,k]=(0,i.useState)([]),[U,A]=(0,i.useState)([]),[P,T]=(0,i.useState)([]),[_,C]=(0,i.useState)([]),[M,x]=(0,i.useState)([]),N=(0,i.useRef)(),R=(0,i.useRef)(),j=(0,i.useRef)(new Map),$=(0,i.useRef)(Date.now()),J=(0,i.useRef)(new Map),L=(0,i.useCallback)(async()=>{if(t&&"connected"!==u){d("connecting");try{await Q(),await z(),await F(),l(!0),d("connected"),q(),f.length>0&&await H()}catch(e){console.error("Real-time connection failed:",e),d("disconnected"),K()}}},[t,u]),V=(0,i.useCallback)(()=>{d("disconnected"),l(!1),j.current.forEach(e=>{e.unsubscribe()}),j.current.clear(),m(new Map),R.current&&clearInterval(R.current),N.current&&clearTimeout(N.current),g({}),p([])},[]),K=(0,i.useCallback)(()=>{N.current&&clearTimeout(N.current);let e=Math.min(1e3*Math.pow(2,"reconnecting"===u?1:0),3e4);N.current=setTimeout(()=>{d("reconnecting"),L()},e)},[L,u]),q=(0,i.useCallback)(()=>{R.current&&clearInterval(R.current),R.current=setInterval(async()=>{try{let{error:e}=await n.OQ.from(n.ji.USERS).select("id").eq("id",t?.id).limit(1);if(e)throw e}catch(e){console.warn("Heartbeat failed:",e),s&&(d("reconnecting"),K())}},3e4)},[t,s,K]),Q=(0,i.useCallback)(async()=>{if(!t)return;let e=n.OQ.channel(`presence-user-${t.id}`,{config:{presence:{key:t.id}}});e.on("presence",{event:"sync"},()=>{let t=e.presenceState();p(Object.keys(t).map(e=>{let[s]=t[e];return s}))}).on("presence",{event:"join"},({key:e,newPresences:t})=>{console.log("User joined:",e,t)}).on("presence",{event:"leave"},({key:e,leftPresences:t})=>{console.log("User left:",e,t)}),await e.subscribe(async s=>{"SUBSCRIBED"===s&&await e.track({user_id:t.id,username:t.displayName||t.id,status:"online",last_seen:new Date().toISOString(),active_session:I?.id||null})}),j.current.set("presence",e),m(t=>new Map(t.set("presence",e)))},[t,I]),z=(0,i.useCallback)(async()=>{if(!t)return;let e=n.OQ.channel(`user-sessions-${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:n.ji.POMODORO_SESSIONS,filter:`user_id=eq.${t.id}`},e=>{B(e)}).subscribe(),s=n.OQ.channel(`user-stats-${t.id}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:n.ji.USER_STATS,filter:`user_id=eq.${t.id}`},e=>{E(e.new)}).subscribe(),r=n.OQ.channel(`user-meetings-${t.id}`).on("postgres_changes",{event:"*",schema:"public",table:n.ji.MEETINGS,filter:`user_id=eq.${t.id}`},e=>{G(e)}).subscribe();j.current.set("sessions",e),j.current.set("stats",s),j.current.set("meetings",r),m(t=>new Map([...t,["sessions",e],["stats",s],["meetings",r]]))},[t]),F=(0,i.useCallback)(async()=>{if(!t)return;let e=n.OQ.channel("global-leaderboard").on("postgres_changes",{event:"UPDATE",schema:"public",table:n.ji.USER_STATS},e=>{W(e)}).subscribe(),s=n.OQ.channel("shared-sessions").on("postgres_changes",{event:"*",schema:"public",table:n.ji.POMODORO_SESSIONS,filter:"shared=eq.true"},e=>{Y(e)}).subscribe();j.current.set("leaderboard",e),j.current.set("shared",s),m(t=>new Map([...t,["leaderboard",e],["shared",s]]))},[t]),B=(0,i.useCallback)(e=>{let{eventType:s,new:r,old:i}=e;switch(s){case"INSERT":"active"===r.status&&(b(r),et({type:"session_started",message:`Pomodoro session "${r.title}" started`,session:r,timestamp:new Date().toISOString()}));break;case"UPDATE":r.user_id===t?.id&&Z(r,i)&&b("active"===r.status?r:null);break;case"DELETE":i.user_id===t?.id&&"active"===i.status&&b(null)}},[t]),G=(0,i.useCallback)(e=>{let{eventType:t,new:s,old:r}=e;if(k(e=>{switch(t){case"INSERT":return[...e,s];case"UPDATE":return e.map(e=>e.id===s.id?s:e);case"DELETE":return e.filter(e=>e.id!==r.id);default:return e}}),"INSERT"===t){let e=new Date(new Date(`${s.date}T${s.time}`).getTime()-6e4*(s.reminder_minutes||15));e>new Date&&setTimeout(()=>{et({type:"meeting_reminder",message:`Meeting "${s.title}" starting in ${s.reminder_minutes||15} minutes`,meeting:s,timestamp:new Date().toISOString()})},e.getTime()-Date.now())}},[]),W=(0,i.useCallback)(e=>{C(t=>t.map(t=>t.user_id===e.new.user_id?{...t,...e.new}:t).sort((e,t)=>t.completed_minutes-e.completed_minutes))},[]),Y=(0,i.useCallback)(e=>{let{eventType:t,new:s,old:r}=e;T(e=>{switch(t){case"INSERT":return[...e,s];case"UPDATE":return e.map(e=>e.id===s.id?s:e);case"DELETE":return e.filter(e=>e.id!==r.id);default:return e}})},[]),Z=(0,i.useCallback)((e,t)=>{let s=`session_${e.id}`,r=J.current.get(s)||0;return Date.now()-r>5e3?(J.current.set(s,Date.now()),!0):new Date(e.updated_at)>=new Date(t.updated_at)},[]),X=(0,i.useCallback)(e=>{w(t=>[...t,{...e,id:`sync_${Date.now()}_${Math.random()}`,timestamp:Date.now(),retries:0}])},[]),H=(0,i.useCallback)(async()=>{if(!y||0===f.length)return;let e=[...f];w([]);let t=[];for(let s of e)try{await ee(s)}catch(e){console.error("Sync operation failed:",e,s),s.retries<3&&t.push({...s,retries:s.retries+1})}t.length>0&&w(e=>[...e,...t])},[y,f]),ee=(0,i.useCallback)(async e=>{let{type:t,table:s,data:r,id:i}=e;switch(t){case"INSERT":let{error:o}=await n.OQ.from(s).insert(r);if(o)throw o;break;case"UPDATE":let{error:a}=await n.OQ.from(s).update(r).eq("id",i);if(a)throw a;break;case"DELETE":let{error:l}=await n.OQ.from(s).delete().eq("id",i);if(l)throw l}},[]),et=(0,i.useCallback)(e=>{A(t=>[{...e,id:`notif_${Date.now()}_${Math.random()}`,read:!1},...t.slice(0,49)])},[]),es=(0,i.useCallback)(e=>{A(t=>t.map(t=>t.id===e?{...t,read:!0}:t))},[]),er=(0,i.useCallback)(()=>{A([])},[]),ei=(0,i.useCallback)(async e=>{let t=j.current.get("presence");t&&await t.track({...S,...e,last_seen:new Date().toISOString()})},[S]),en=(0,i.useCallback)(async(e,t,s)=>{let r=j.current.get(e);r&&await r.send({type:"broadcast",event:t,payload:s})},[]),eo=(0,i.useCallback)(async(e,t)=>{switch(e.table){case n.ji.POMODORO_SESSIONS:"UPDATE"===e.type&&"active"===t.status&&b(t);break;case n.ji.USER_STATS:"UPDATE"===e.type&&E(e=>({...e,...t}))}if(y&&s)try{await ee(e)}catch(t){console.error("Optimistic update failed, rolling back:",t),X(e)}else X(e)},[y,s,X,ee]);(0,i.useEffect)(()=>{let e=()=>{v(!0),t&&L()},s=()=>{v(!1),d("disconnected")};return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[t,L]),(0,i.useEffect)(()=>{t&&y&&"disconnected"===u?L():t||"disconnected"===u||V()},[t,y,u,L,V]),(0,i.useEffect)(()=>()=>{V()},[V]),(0,i.useEffect)(()=>{let e=setInterval(async()=>{s&&t&&(Date.now()-$.current>3e5||f.length>0)&&(await H(),$.current=Date.now())},6e4);return()=>clearInterval(e)},[s,t,f,H]);let ea={isConnected:s,connectionStatus:u,isOnline:y,realtimeSession:I,realtimeStats:O,realtimeMeetings:D,notifications:U,presenceData:S,onlineUsers:h,updatePresence:ei,sharedSessions:P,leaderboard:_,activityFeed:M,syncQueue:f,optimisticUpdate:eo,addToSyncQueue:X,addNotification:et,markNotificationAsRead:es,clearNotifications:er,connect:L,disconnect:V,broadcastMessage:en,subscriptions:Array.from(c.keys())};return r.jsx(a.Provider,{value:ea,children:e})}},3987:(e,t,s)=>{"use strict";s.d(t,{UserProvider:()=>l,a:()=>a});var r=s(326),i=s(7577),n=s(2348);let o=(0,i.createContext)(),a=()=>{let e=(0,i.useContext)(o);if(!e)throw Error("useUser must be used within a UserProvider");return e},l=({children:e})=>{let[t,s]=(0,i.useState)(null),[a]=(0,i.useState)(()=>new n.w),[l,u]=(0,i.useState)(null),[d,c]=(0,i.useState)(null),[m,S]=(0,i.useState)(!1),[g,h]=(0,i.useState)(!0),[p,f]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{try{let e=a.getCurrentSession();if(e){let t=a.getUser(e.userId);t?(s(t),c(e.token),S(!0),I(e.userId)):a.logoutSession()}}catch(e){console.error("Error initializing auth:",e),a.logoutSession()}finally{h(!1)}})();let e=setInterval(()=>{if(d){let e=a.validateSession(d);if(e){let t=new Date(e.expiresAt),s=new Date,r=t.getTime()-s.getTime();r>0&&r<=3e5&&!e.rememberMe?f(`세션이 ${Math.ceil(r/6e4)}분 후 만료됩니다.`):f(null)}else f("세션이 만료되어 자동으로 로그아웃됩니다."),setTimeout(()=>v(),3e3)}},3e4);return()=>clearInterval(e)},[a,d]);let w=async(e,t,r=!1)=>{try{if(h(!0),f(null),!e?.trim())throw Error("사용자명을 입력해주세요.");if(!t)throw Error("비밀번호를 입력해주세요.");let i=await a.loginUser(e.trim(),t,r);return s(i.user),c(i.sessionToken),S(!0),I(i.user.id),i.user}catch(e){if(console.error("Login failed:",e),e.message.includes("존재하지 않는"))throw Error("존재하지 않는 사용자입니다. 사용자명을 확인해주세요.");if(e.message.includes("비밀번호가 올바르지"))throw e;if(e.message.includes("일시적으로 잠겼습니다"))throw e;throw Error("로그인에 실패했습니다. 사용자명과 비밀번호를 확인해주세요.")}finally{h(!1)}},y=async(e,t)=>{try{if(h(!0),f(null),!e?.trim())throw Error("사용자명을 입력해주세요.");if(!t?.email?.trim())throw Error("이메일을 입력해주세요.");if(!t?.password)throw Error("비밀번호를 입력해주세요.");return await a.registerUser(e.trim(),{...t,email:t.email.trim()})}catch(e){if(console.error("Registration failed:",e),e.message.includes("이미 존재하는"))throw Error("이미 사용 중인 사용자명입니다. 다른 사용자명을 선택해주세요.");if(e.message.includes("이미 사용 중인 이메일"))throw Error("이미 사용 중인 이메일 주소입니다. 다른 이메일을 사용해주세요.");if(e.message.includes("비밀번호"))throw e;if(e.message.includes("이메일"))throw e;else if(e.message.includes("사용자명"))throw e;else throw Error("회원가입에 실패했습니다. 입력 정보를 확인하고 다시 시도해주세요.")}finally{h(!1)}},v=()=>{try{a.logoutSession(d),s(null),u(null),c(null),S(!1),f(null)}catch(e){console.error("Logout error:",e),s(null),u(null),c(null),S(!1),f(null)}},I=e=>{let t=a.getActiveSession(e);t&&(new Date<new Date(t.endTime)?u(t):(a.clearActiveSession(e),u(null)))},b=async e=>{if(!t)throw Error("No user logged in");try{let r=await a.updateUserProfile(t.id,e);return s(r),r}catch(e){throw console.error("Profile update failed:",e),e}};return r.jsx(o.Provider,{value:{currentUser:t,activeSession:l,sessionToken:d,isSessionValid:m,authLoading:g,sessionWarning:p,loginUser:w,registerUser:y,logoutUser:v,createPomodoroSession:e=>{if(!t)throw Error("No user logged in");let s=a.createPomodoroSession(t.id,e);return u(s),s},completePomodoroSession:()=>{t&&l&&(a.completePomodoroSession(t.id,l.id),u(null))},stopPomodoroSession:()=>{t&&l&&(a.stopPomodoroSession(t.id,l.id),u(null))},getUserStats:()=>t?a.getUserStats(t.id):null,getUserSessions:()=>t?a.getUserSessions(t.id):[],updateUserProfile:b,getUserActivity:(e=30)=>t?a.getUserActivity(t.id,e):null,validateCurrentSession:()=>!!d&&(!!a.validateSession(d)||(v(),!1)),checkPasswordStrength:e=>{if(!e)return{isValid:!1,errors:["비밀번호를 입력해주세요"],warnings:[],score:0,strength:"weak"};let t=[];e.length<4&&t.push("비밀번호는 4자 이상이어야 합니다");let s=Math.min(10*e.length,100),r={medium:s>=50&&s<80,strong:s>=80};return{isValid:0===t.length,errors:t,warnings:[],score:s,strength:r.strong?"strong":r.medium?"medium":"weak"}},validateEmail:e=>{if(!e||"string"!=typeof e)return{isValid:!1,error:"이메일을 입력해주세요."};let t=e.trim().toLowerCase();return t.includes("@")?{isValid:!0,normalizedEmail:t}:{isValid:!1,error:"이메일에 @가 포함되어야 합니다."}},validateUsername:e=>{if(!e||"string"!=typeof e)return{isValid:!1,error:"사용자명을 입력해주세요."};let t=e.trim();return t.length<1?{isValid:!1,error:"사용자명을 입력해주세요."}:t.length>50?{isValid:!1,error:"사용자명은 50자 이하여야 합니다."}:{isValid:!0,normalizedUsername:t.toLowerCase()}},extendSession:()=>!!(d&&a.validateSession(d))&&(f(null),!0),dismissSessionWarning:()=>{f(null)},userManager:a},children:e})}},2348:(e,t,s)=>{"use strict";s.d(t,{w:()=>a});let r=e=>{let t=[];e.length<4&&t.push("비밀번호는 4자 이상이어야 합니다");let s=Math.min(10*e.length,100),r={medium:s>=50&&s<80,strong:s>=80};return{isValid:0===t.length,errors:t,warnings:[],score:s,strength:r.strong?"strong":r.medium?"medium":"weak"}},i=e=>{if(!e||"string"!=typeof e)return{isValid:!1,error:"이메일을 입력해주세요."};let t=e.trim().toLowerCase();return t.includes("@")?{isValid:!0,normalizedEmail:t}:{isValid:!1,error:"이메일에 @가 포함되어야 합니다."}},n=e=>{if(!e||"string"!=typeof e)return{isValid:!1,error:"사용자명을 입력해주세요."};let t=e.trim();return t.length<1?{isValid:!1,error:"사용자명을 입력해주세요."}:t.length>50?{isValid:!1,error:"사용자명은 50자 이하여야 합니다."}:{isValid:!0,normalizedUsername:t}},o={getItem:e=>null,setItem:(e,t)=>{},removeItem:e=>{}};class a{constructor(){this.usersKey="registeredUsers",this.sessionsKey="userSessions",this.sessionTimeout=18e5,this.extendedSessionTimeout=6048e5,this.maxLoginAttempts=5,this.accountLockTime=18e5,this.sessionCleanupInterval=null,this.init()}init(){}isUsernameUnique(e){return!this.getAllUsers()[e]}isEmailUnique(e){return!Object.values(this.getAllUsers()).some(t=>t.email===e)}async registerUser(e,t={}){if(!e||"string"!=typeof e)throw Error("유효한 사용자 ID가 필요합니다.");let s=n(e);if(!s.isValid)throw Error(s.error);if(!t.password)throw Error("비밀번호가 필요합니다.");if(!t.email)throw Error("이메일이 필요합니다.");try{let s=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t.email,password:t.password,displayName:t.displayName||e})}),r=await s.json();if(!s.ok)throw Error(r.error||"Registration failed");return r.data.user}catch(e){throw console.error("Registration API error:",e),Error(e.message||"회원가입에 실패했습니다.")}}initializeUserStats(e){let t=`userStats_${e}`,s={userId:e,totalSessions:0,completedSessions:0,totalMinutes:0,completedMinutes:0,streakDays:0,longestStreak:0,lastSessionDate:null,weeklyGoal:140,monthlyStats:{},dailyStats:{},tags:{},locations:{},completionRate:0,averageSessionLength:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};o.setItem(t,JSON.stringify(s));let r=`pomodoroSessions_${e}`;o.setItem(r,JSON.stringify([]))}async loginUser(e,t,s=!1){if(!e||!t)throw Error("사용자명과 비밀번호가 필요합니다.");try{let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t,rememberMe:s})}),i=await r.json();if(!r.ok)throw Error(i.error||"Login failed");let n=i.data.session.accessToken,a={userId:i.data.user.id,token:n,createdAt:new Date().toISOString(),expiresAt:new Date(1e3*i.data.session.expiresAt).toISOString(),rememberMe:s,lastActivity:new Date().toISOString(),isActive:!0},l=this.getSessions();return l[n]=a,o.setItem(this.sessionsKey,JSON.stringify(l)),o.setItem("currentSessionToken",n),{user:i.data.user,sessionToken:n}}catch(e){throw console.error("Login API error:",e),Error(e.message||"로그인에 실패했습니다.")}}getUser(e){let t=this.getAllUsers()[e];return t?{id:t.id,displayName:t.displayName,email:t.email,createdAt:t.createdAt,lastLogin:t.lastLogin,preferences:t.preferences,avatar:t.avatar,bio:t.bio,emailVerified:t.emailVerified}:null}getAllUsers(){return JSON.parse(o.getItem(this.usersKey)||"{}")}getSessions(){return JSON.parse(o.getItem(this.sessionsKey)||"{}")}getUserStats(e){let t=`userStats_${e}`;return JSON.parse(o.getItem(t)||"null")||(this.initializeUserStats(e),JSON.parse(o.getItem(t)))}getUserSessions(e){let t=`pomodoroSessions_${e}`;return JSON.parse(o.getItem(t)||"[]")}getActiveSession(e){let t=`activePomodoroSession_${e}`,s=o.getItem(t);return s?JSON.parse(s):null}createPomodoroSession(e,t){let s;let r=new Date;if(t.scheduledTime){let e=new Date(t.scheduledTime);s=e>r?e:r}else s=r;let i=`session_${Date.now()}`,n=6e4*(t.duration||25),a={id:i,title:t.title||"뽀모도로 세션",goal:t.goal||"",tags:t.tags||"",location:t.location||"",duration:t.duration||25,startTime:s.toISOString(),endTime:new Date(s.getTime()+n).toISOString(),user:e,status:"active",createdAt:r.toISOString()},l=`activePomodoroSession_${e}`;o.setItem(l,JSON.stringify(a));let u=`pomodoroSessions_${e}`,d=JSON.parse(o.getItem(u)||"[]");return d.push({...a,status:"scheduled"}),o.setItem(u,JSON.stringify(d)),this.updateUserStatsForNewSession(e,a),a}updateUserStatsForNewSession(e,t){let s=this.getUserStats(e),r={totalSessions:s.totalSessions+1,totalMinutes:s.totalMinutes+t.duration},i=new Date().toISOString().split("T")[0];s.dailyStats[i]||(s.dailyStats[i]={sessions:0,minutes:0,completed:0}),s.dailyStats[i].sessions++,s.dailyStats[i].minutes+=t.duration,r.dailyStats=s.dailyStats;let n=i.substring(0,7);s.monthlyStats[n]||(s.monthlyStats[n]={sessions:0,minutes:0,completed:0}),s.monthlyStats[n].sessions++,s.monthlyStats[n].minutes+=t.duration,r.monthlyStats=s.monthlyStats,t.tags&&(t.tags.split(",").map(e=>e.trim()).filter(e=>e).forEach(e=>{s.tags[e]||(s.tags[e]={count:0,minutes:0}),s.tags[e].count++,s.tags[e].minutes+=t.duration}),r.tags=s.tags),t.location&&(s.locations[t.location]||(s.locations[t.location]={count:0,minutes:0}),s.locations[t.location].count++,s.locations[t.location].minutes+=t.duration,r.locations=s.locations),this.updateStreak(s,i),r.streakDays=s.streakDays,r.longestStreak=s.longestStreak,r.lastSessionDate=i,this.updateUserStats(e,r)}updateStreak(e,t){let s=e.lastSessionDate;if(s){let r=new Date(s),i=Math.floor((new Date(t)-r)/864e5);0===i||(1===i?e.streakDays++:e.streakDays=1)}else e.streakDays=1;e.streakDays>e.longestStreak&&(e.longestStreak=e.streakDays)}completePomodoroSession(e,t){let s=`activePomodoroSession_${e}`,r=JSON.parse(o.getItem(s)||"null");if(!r||r.id!==t)return;o.removeItem(s);let i=`pomodoroSessions_${e}`,n=JSON.parse(o.getItem(i)||"[]"),a=n.findIndex(e=>e.id===t);a>=0&&(n[a].status="completed",n[a].completedAt=new Date().toISOString(),o.setItem(i,JSON.stringify(n))),this.updateUserStatsForCompletion(e,r)}updateUserStatsForCompletion(e,t){let s=this.getUserStats(e),r={completedSessions:s.completedSessions+1,completedMinutes:s.completedMinutes+t.duration},i=new Date().toISOString().split("T")[0];s.dailyStats[i]&&(s.dailyStats[i].completed++,r.dailyStats=s.dailyStats);let n=i.substring(0,7);s.monthlyStats[n]&&(s.monthlyStats[n].completed++,r.monthlyStats=s.monthlyStats),this.updateUserStats(e,r)}stopPomodoroSession(e,t){let s=`activePomodoroSession_${e}`;o.removeItem(s);let r=`pomodoroSessions_${e}`,i=JSON.parse(o.getItem(r)||"[]"),n=i.findIndex(e=>e.id===t);n>=0&&(i[n].status="stopped",i[n].stoppedAt=new Date().toISOString(),o.setItem(r,JSON.stringify(i)))}clearActiveSession(e){let t=`activePomodoroSession_${e}`;o.removeItem(t)}updateUserStats(e,t){let s=`userStats_${e}`,r={...this.getUserStats(e),...t,updatedAt:new Date().toISOString()};return r.totalSessions>0&&(r.completionRate=Math.round(r.completedSessions/r.totalSessions*100)),r.completedSessions>0&&(r.averageSessionLength=Math.round(r.completedMinutes/r.completedSessions)),o.setItem(s,JSON.stringify(r)),r}validateSession(e){if(!e)return null;let t=this.getSessions(),s=t[e];if(!s||!s.isActive)return null;let r=new Date;if(r>new Date(s.expiresAt))return this.invalidateSession(e),null;let i=this.getClientIP();s.ipAddress&&i&&s.ipAddress!==i&&console.warn("Session IP mismatch detected:",{original:s.ipAddress,current:i}),s.lastActivity=r.toISOString();let n=s.rememberMe?this.extendedSessionTimeout:this.sessionTimeout;return s.expiresAt=new Date(r.getTime()+n).toISOString(),t[e]=s,o.setItem(this.sessionsKey,JSON.stringify(t)),s}getCurrentSession(){let e=o.getItem("currentSessionToken");return this.validateSession(e)}logoutSession(e=null){let t=e||o.getItem("currentSessionToken");t&&this.invalidateSession(t),o.removeItem("currentSessionToken"),o.removeItem("currentUser")}invalidateSession(e){let t=this.getSessions();t[e]&&(t[e].isActive=!1,t[e].invalidatedAt=new Date().toISOString(),o.setItem(this.sessionsKey,JSON.stringify(t)))}invalidateAllUserSessions(e){let t=this.getSessions(),s=!1;Object.keys(t).forEach(r=>{t[r].userId===e&&t[r].isActive&&(t[r].isActive=!1,t[r].invalidatedAt=new Date().toISOString(),s=!0)}),s&&o.setItem(this.sessionsKey,JSON.stringify(t))}getClientIP(){return"browser-client"}cleanupExpiredSessions(){let e=this.getSessions(),t=new Date,s=!1;return Object.keys(e).forEach(r=>{let i=e[r];(new Date(i.expiresAt)<=t||!i.isActive)&&(delete e[r],s=!0)}),s&&o.setItem(this.sessionsKey,JSON.stringify(e)),s}getActiveSessions(e){let t=this.getSessions(),s=new Date;return Object.values(t).filter(t=>t.userId===e&&t.isActive&&new Date(t.expiresAt)>s).map(e=>({token:e.token,createdAt:e.createdAt,lastActivity:e.lastActivity,expiresAt:e.expiresAt,rememberMe:e.rememberMe,ipAddress:e.ipAddress,userAgent:e.userAgent}))}destroy(){this.sessionCleanupInterval&&(clearInterval(this.sessionCleanupInterval),this.sessionCleanupInterval=null)}async updateUserProfile(e,t){let s=this.getAllUsers(),n=s[e];if(!n)throw Error("User not found");if(t.newPassword){if(!t.currentPassword)throw Error("현재 비밀번호가 필요합니다.");if(t.currentPassword!==n.password)throw Error("현재 비밀번호가 올바르지 않습니다.");let e=r(t.newPassword);if(!e.isValid)throw Error("비밀번호 강도가 부족합니다: "+e.errors.join(", "));n.password=t.newPassword}if(t.email&&t.email!==n.email){if(!i(t.email))throw Error("유효한 이메일 주소를 입력해주세요.");if(!this.isEmailUnique(t.email))throw Error("이미 사용 중인 이메일 주소입니다.");n.email=t.email,n.emailVerified=!1}return t.displayName&&(n.displayName=t.displayName),void 0!==t.bio&&(n.bio=t.bio),void 0!==t.avatar&&(n.avatar=t.avatar),t.preferences&&(n.preferences={...n.preferences,...t.preferences}),n.updatedAt=new Date().toISOString(),o.setItem(this.usersKey,JSON.stringify(s)),this.getUser(e)}getUserActivity(e,t=30){let s=this.getUserSessions(e),r=this.getUserStats(e),i=new Date;i.setDate(i.getDate()-t);let n=s.filter(e=>new Date(e.createdAt)>=i),o={};return n.forEach(e=>{let t=e.createdAt.split("T")[0];o[t]||(o[t]={sessions:0,completed:0,totalMinutes:0,completedMinutes:0}),o[t].sessions++,o[t].totalMinutes+=e.duration,"completed"===e.status&&(o[t].completed++,o[t].completedMinutes+=e.duration)}),{totalSessions:n.length,completedSessions:n.filter(e=>"completed"===e.status).length,totalMinutes:n.reduce((e,t)=>e+t.duration,0),completedMinutes:n.filter(e=>"completed"===e.status).reduce((e,t)=>e+t.duration,0),activityByDay:o,currentStreak:r.streakDays,longestStreak:r.longestStreak}}deleteUser(e){if(!e)return!1;let t=this.getAllUsers();delete t[e],o.setItem(this.usersKey,JSON.stringify(t)),[`userStats_${e}`,`pomodoroSessions_${e}`,`activePomodoroSession_${e}`,`meetings_${e}`].forEach(e=>{o.removeItem(e)});let s=this.getSessions();return Object.keys(s).forEach(t=>{s[t].userId===e&&delete s[t]}),o.setItem(this.sessionsKey,JSON.stringify(s)),!0}getMeetings(e){let t=`meetings_${e}`,s=o.getItem(t);return s?JSON.parse(s):[]}saveMeeting(e,t){let s=this.getMeetings(e),r={id:Date.now().toString(),...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};s.push(r);let i=`meetings_${e}`;return o.setItem(i,JSON.stringify(s)),r}updateMeeting(e,t,s){let r=this.getMeetings(e),i=r.findIndex(e=>e.id===t);if(-1===i)return null;r[i]={...r[i],...s,updatedAt:new Date().toISOString()};let n=`meetings_${e}`;return o.setItem(n,JSON.stringify(r)),r[i]}deleteMeeting(e,t){let s=this.getMeetings(e).filter(e=>e.id!==t),r=`meetings_${e}`;return o.setItem(r,JSON.stringify(s)),!0}getUpcomingMeetings(e,t=5){let s=this.getMeetings(e),r=new Date;return s.filter(e=>new Date(e.date+"T"+e.time)>=r).sort((e,t)=>new Date(e.date+"T"+e.time)-new Date(t.date+"T"+t.time)).slice(0,t)}getMeetingsForDate(e,t){let s=this.getMeetings(e),r="string"==typeof t?t:t.toISOString().split("T")[0];return s.filter(e=>e.date===r).sort((e,t)=>e.time.localeCompare(t.time))}getMeetingsForWeek(e,t){let s=this.getMeetings(e),r=new Date(t),i=new Date(r);i.setDate(r.getDate()+6);let n=r.toISOString().split("T")[0],o=i.toISOString().split("T")[0];return s.filter(e=>e.date>=n&&e.date<=o).sort((e,t)=>{let s=e.date.localeCompare(t.date);return 0===s?e.time.localeCompare(t.time):s})}getMeetingsForMonth(e,t,s){let r=this.getMeetings(e),i=`${t}-${String(s).padStart(2,"0")}`;return r.filter(e=>e.date.startsWith(i)).sort((e,t)=>{let s=e.date.localeCompare(t.date);return 0===s?e.time.localeCompare(t.time):s})}clearAllData(){return!1}}},785:(e,t,s)=>{"use strict";s.d(t,{OQ:()=>d,ji:()=>c});var r=s(7939);let i="https://demo.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlbW8iLCJyb2xlIjoiYW5vbiIsImlhdCI6MTY0NjkyODAwMCwiZXhwIjoxOTYyNTA0MDAwfQ.demo-key-for-local-development",o=process.env.SUPABASE_SERVICE_ROLE_KEY,a=e=>{if(!e||e.includes("your_supabase")||e.includes("placeholder")||e.includes("demo.supabase.co"))return!1;try{return new URL(e),e.includes("supabase.co")}catch{return!1}},l=a(i)&&n&&!n.includes("your_");console.log("Supabase Configuration Status:",{url:i?"Present":"Missing",urlValid:a(i),anonKey:n?"Present":"Missing",anonKeyValid:n&&!n.includes("your_"),hasValidConfig:l});let u=()=>{let e={select:function(){return this},insert:function(){return this},update:function(){return this},delete:function(){return this},eq:function(){return this},neq:function(){return this},gt:function(){return this},gte:function(){return this},lt:function(){return this},lte:function(){return this},like:function(){return this},ilike:function(){return this},is:function(){return this},in:function(){return this},contains:function(){return this},containedBy:function(){return this},rangeGt:function(){return this},rangeGte:function(){return this},rangeLt:function(){return this},rangeLte:function(){return this},rangeAdjacent:function(){return this},overlaps:function(){return this},textSearch:function(){return this},match:function(){return this},not:function(){return this},or:function(){return this},filter:function(){return this},order:function(){return this},limit:function(){return this},range:function(){return this},abortSignal:function(){return this},single:function(){return Promise.resolve({data:null,error:{message:"Using localStorage mode - no data available"}})},maybeSingle:function(){return Promise.resolve({data:null,error:null})},then:function(e){return e({data:[],error:null})},catch:function(){return this}};return{from:()=>e,auth:{signUp:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signInWithPassword:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signOut:()=>Promise.resolve({error:null}),getUser:()=>Promise.resolve({data:{user:null},error:{message:"Using localStorage mode"}}),getSession:()=>Promise.resolve({data:{session:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},channel:()=>({on:function(){return this},subscribe:()=>Promise.resolve("SUBSCRIBED"),unsubscribe:()=>{},track:()=>Promise.resolve(),send:()=>Promise.resolve(),presenceState:()=>({})}),realtime:{disconnect:()=>{}}}},d=l?(0,r.eI)(i,n,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:void 0},realtime:{params:{eventsPerSecond:10}}}):u();l&&o?(0,r.eI)(i,o,{auth:{autoRefreshToken:!1,persistSession:!1}}):u();let c={USERS:"users",USER_PREFERENCES:"user_preferences",USER_STATS:"user_stats",POMODORO_SESSIONS:"pomodoro_sessions",MEETINGS:"meetings",AUTH_SESSIONS:"auth_sessions"}},4378:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u,metadata:()=>l});var r=s(9510),i=s(8570);(0,i.createProxy)(String.raw`/home/devswha/workspace/pomodoro/lib/contexts/UserContext.js#useUser`);let n=(0,i.createProxy)(String.raw`/home/devswha/workspace/pomodoro/lib/contexts/UserContext.js#UserProvider`);(0,i.createProxy)(String.raw`/home/devswha/workspace/pomodoro/lib/contexts/RealtimeContext.js#useRealtime`);let o=(0,i.createProxy)(String.raw`/home/devswha/workspace/pomodoro/lib/contexts/RealtimeContext.js#RealtimeProvider`);(0,i.createProxy)(String.raw`/home/devswha/workspace/pomodoro/lib/contexts/RealtimeContext.js#default`),s(7272);let a=(0,i.createProxy)(String.raw`/home/devswha/workspace/pomodoro/lib/components/ClientLayout.js#default`),l={title:"Pomodoro Timer v1.0.1 - Real-time Sync",description:"Modern React-based pomodoro timer with real-time sync, multi-device support, and collaborative features",viewport:"width=device-width, initial-scale=1"};function u({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{children:r.jsx(n,{children:r.jsx(o,{children:r.jsx(a,{children:e})})})})})}}};