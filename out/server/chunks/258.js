"use strict";exports.id=258,exports.ids=[258],exports.modules={7258:(e,r,n)=>{n.d(r,{Rw:()=>c,mk:()=>l});var t=n(1482),s=n(1595),i=n(2859);let o=e=>{let r=e.headers.authorization;return r?r.startsWith("Bearer ")?r.substring(7):r:null},u=e=>{try{let r=process.env.JWT_SECRET;if(!r)throw Error("JWT_SECRET not configured");return t.verify(e,r)}catch(e){return null}},a=async e=>{try{let{data:{user:r},error:n}=await s.OQ.auth.getUser(e);if(n||!r)return null;return r}catch(e){return null}},l=async(e,r,n)=>{try{let t=o(e);if(!t)return(0,i.LW)(r,"Access token required");let s=await a(t);if(!s){let e=u(t);e&&e.userId&&(s={id:e.userId,email:e.email})}if(!s)return(0,i.LW)(r,"Invalid or expired token");e.user=s,e.userId=s.id,n()}catch(e){return console.error("Authentication middleware error:",e),(0,i.LW)(r,"Authentication failed")}},c=async(e,r,n)=>{try{let r=o(e);if(!r)return e.user=null,e.userId=null,n();let t=await a(r);if(!t){let e=u(r);e&&e.userId&&(t={id:e.userId,email:e.email})}e.user=t,e.userId=t?.id||null,n()}catch(r){console.error("Optional auth middleware error:",r),e.user=null,e.userId=null,n()}}},1595:(e,r,n)=>{n.d(r,{OQ:()=>c,ji:()=>h,pR:()=>d});var t=n(9498);let s="https://demo.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlbW8iLCJyb2xlIjoiYW5vbiIsImlhdCI6MTY0NjkyODAwMCwiZXhwIjoxOTYyNTA0MDAwfQ.demo-key-for-local-development",o=process.env.SUPABASE_SERVICE_ROLE_KEY,u=e=>{if(!e||e.includes("your_supabase")||e.includes("placeholder")||e.includes("demo.supabase.co"))return!1;try{return new URL(e),e.includes("supabase.co")}catch{return!1}},a=u(s)&&i&&!i.includes("your_");console.log("Supabase Configuration Status:",{url:s?"Present":"Missing",urlValid:u(s),anonKey:i?"Present":"Missing",anonKeyValid:i&&!i.includes("your_"),hasValidConfig:a});let l=()=>{let e={select:function(){return this},insert:function(){return this},update:function(){return this},delete:function(){return this},eq:function(){return this},neq:function(){return this},gt:function(){return this},gte:function(){return this},lt:function(){return this},lte:function(){return this},like:function(){return this},ilike:function(){return this},is:function(){return this},in:function(){return this},contains:function(){return this},containedBy:function(){return this},rangeGt:function(){return this},rangeGte:function(){return this},rangeLt:function(){return this},rangeLte:function(){return this},rangeAdjacent:function(){return this},overlaps:function(){return this},textSearch:function(){return this},match:function(){return this},not:function(){return this},or:function(){return this},filter:function(){return this},order:function(){return this},limit:function(){return this},range:function(){return this},abortSignal:function(){return this},single:function(){return Promise.resolve({data:null,error:{message:"Using localStorage mode - no data available"}})},maybeSingle:function(){return Promise.resolve({data:null,error:null})},then:function(e){return e({data:[],error:null})},catch:function(){return this}};return{from:()=>e,auth:{signUp:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signInWithPassword:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signOut:()=>Promise.resolve({error:null}),getUser:()=>Promise.resolve({data:{user:null},error:{message:"Using localStorage mode"}}),getSession:()=>Promise.resolve({data:{session:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},channel:()=>({on:function(){return this},subscribe:()=>Promise.resolve("SUBSCRIBED"),unsubscribe:()=>{},track:()=>Promise.resolve(),send:()=>Promise.resolve(),presenceState:()=>({})}),realtime:{disconnect:()=>{}}}},c=a?(0,t.eI)(s,i,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:void 0},realtime:{params:{eventsPerSecond:10}}}):l(),d=a&&o?(0,t.eI)(s,o,{auth:{autoRefreshToken:!1,persistSession:!1}}):l(),h={USERS:"users",USER_PREFERENCES:"user_preferences",USER_STATS:"user_stats",POMODORO_SESSIONS:"pomodoro_sessions",MEETINGS:"meetings",AUTH_SESSIONS:"auth_sessions"}},2859:(e,r,n)=>{n.d(r,{Gc:()=>m,Hm:()=>d,Ij:()=>h,LW:()=>c,P:()=>S,Wr:()=>a,Xs:()=>f,bi:()=>E,kv:()=>I,y7:()=>l});let t=(e,r=null,n=null,t={})=>{let s={success:e,timestamp:new Date().toISOString(),...t};return e?(s.data=r,n&&(s.message=n)):(s.error=n||"An error occurred",r&&(s.details=r)),s},s=(e,r=null,n={})=>t(!0,e,r,n),i=(e,r=null,n={})=>t(!1,r,e,n),o={OK:200,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,CONFLICT:409,UNPROCESSABLE_ENTITY:422,INTERNAL_SERVER_ERROR:500},u=(e,r,n)=>Response.json(n,{status:r}),a=(e,r,n=null,t=o.OK,i={})=>u(e,t,s(r,n,i)),l=(e,r,n=o.INTERNAL_SERVER_ERROR,t=null,s={})=>u(e,n,i(r,t,s)),c=(e,r="Unauthorized")=>l(e,r,o.UNAUTHORIZED),d=(e,r="Forbidden")=>l(e,r,o.FORBIDDEN),h=(e,r="Resource not found")=>l(e,r,o.NOT_FOUND),f=(e,r="Resource conflict",n=null)=>l(e,r,o.CONFLICT,n),m=(e,r,n="Validation failed")=>l(e,n,o.UNPROCESSABLE_ENTITY,r),g=(e,r="Internal server error",n=null)=>(n&&console.error("Internal server error:",n),l(e,r,o.INTERNAL_SERVER_ERROR)),E=e=>async(r,n)=>{try{await e(r,n)}catch(e){if(console.error("API route error:",e),"ValidationError"===e.name)return m(n,e.errors,e.message);if("UnauthorizedError"===e.name)return c(n,e.message);if("ForbiddenError"===e.name)return d(n,e.message);if("NotFoundError"===e.name)return h(n,e.message);if("ConflictError"===e.name)return f(n,e.message,e.details);return g(n,"An unexpected error occurred",e)}},I=(e,r,n)=>{let t=Math.ceil(n/r);return{pagination:{currentPage:e,totalPages:t,totalCount:n,limit:r,hasNextPage:e<t,hasPrevPage:e>1}}},S=(e,r,n)=>!!n.includes(e.method)||(r.setHeader("Allow",n.join(", ")),l(r,`Method ${e.method} not allowed`,405))}};