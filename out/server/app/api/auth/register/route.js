"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},5240:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},7189:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>p});var a={};r.r(a),r.d(a,{POST:()=>d});var n=r(9303),i=r(8716),o=r(670),s=r(1595),l=r(7246),u=r(2859);let d=async function(e){let t=await e.json(),r=(0,l.Fv)(l.gY,t);if(!r.success)return(0,u.Gc)(null,r.errors);let{username:a,email:n,password:i,displayName:o}=r.data;try{if(s.pR){let{data:e}=await s.pR.from(s.ji.USERS).select("id").eq("username",a.toLowerCase()).single();if(e)return(0,u.Xs)(null,"Username already exists")}let{data:e,error:t}=await s.OQ.auth.signUp({email:n,password:i,options:{data:{username:a.toLowerCase(),display_name:o||a}}});if(t){if(t.message.includes("already registered"))return(0,u.Xs)(null,"Email already registered");return(0,u.y7)(null,t.message,400)}let r=e.user;if(!r)return(0,u.y7)(null,"User registration failed",500);if(s.pR){let{error:e}=await s.pR.from(s.ji.USERS).insert({id:r.id,username:a.toLowerCase(),email:n.toLowerCase(),display_name:o||a,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});e&&console.error("Failed to create user profile:",e),await s.pR.from(s.ji.USER_PREFERENCES).insert({user_id:r.id,default_pomodoro_length:25,break_length:5,long_break_length:15,weekly_goal:140,theme:"default",sound_enabled:!0,notifications_enabled:!0,auto_start_break:!1,auto_start_pomodoro:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single(),await s.pR.from(s.ji.USER_STATS).insert({user_id:r.id,total_sessions:0,completed_sessions:0,total_minutes:0,completed_minutes:0,streak_days:0,longest_streak:0,weekly_goal:140,completion_rate:0,average_session_length:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})}let l={user:{id:r.id,email:r.email,username:a.toLowerCase(),displayName:o||a,emailConfirmed:!!r.email_confirmed_at,createdAt:r.created_at},session:e.session,message:r.email_confirmed_at?"Registration successful":"Registration successful. Please check your email to verify your account."};return(0,u.Wr)(null,l,l.message,201)}catch(e){return console.error("Registration error:",e),(0,u.y7)(null,"Registration failed",500)}},m=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/home/devswha/workspace/pomodoro/app/api/auth/register/route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:f}=m,g="/api/auth/register/route";function h(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:p})}},1595:(e,t,r)=>{r.d(t,{OQ:()=>d,ji:()=>c,pR:()=>m});var a=r(9498);let n="https://demo.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlbW8iLCJyb2xlIjoiYW5vbiIsImlhdCI6MTY0NjkyODAwMCwiZXhwIjoxOTYyNTA0MDAwfQ.demo-key-for-local-development",o=process.env.SUPABASE_SERVICE_ROLE_KEY,s=e=>{if(!e||e.includes("your_supabase")||e.includes("placeholder")||e.includes("demo.supabase.co"))return!1;try{return new URL(e),e.includes("supabase.co")}catch{return!1}},l=s(n)&&i&&!i.includes("your_");console.log("Supabase Configuration Status:",{url:n?"Present":"Missing",urlValid:s(n),anonKey:i?"Present":"Missing",anonKeyValid:i&&!i.includes("your_"),hasValidConfig:l});let u=()=>{let e={select:function(){return this},insert:function(){return this},update:function(){return this},delete:function(){return this},eq:function(){return this},neq:function(){return this},gt:function(){return this},gte:function(){return this},lt:function(){return this},lte:function(){return this},like:function(){return this},ilike:function(){return this},is:function(){return this},in:function(){return this},contains:function(){return this},containedBy:function(){return this},rangeGt:function(){return this},rangeGte:function(){return this},rangeLt:function(){return this},rangeLte:function(){return this},rangeAdjacent:function(){return this},overlaps:function(){return this},textSearch:function(){return this},match:function(){return this},not:function(){return this},or:function(){return this},filter:function(){return this},order:function(){return this},limit:function(){return this},range:function(){return this},abortSignal:function(){return this},single:function(){return Promise.resolve({data:null,error:{message:"Using localStorage mode - no data available"}})},maybeSingle:function(){return Promise.resolve({data:null,error:null})},then:function(e){return e({data:[],error:null})},catch:function(){return this}};return{from:()=>e,auth:{signUp:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signInWithPassword:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signOut:()=>Promise.resolve({error:null}),getUser:()=>Promise.resolve({data:{user:null},error:{message:"Using localStorage mode"}}),getSession:()=>Promise.resolve({data:{session:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},channel:()=>({on:function(){return this},subscribe:()=>Promise.resolve("SUBSCRIBED"),unsubscribe:()=>{},track:()=>Promise.resolve(),send:()=>Promise.resolve(),presenceState:()=>({})}),realtime:{disconnect:()=>{}}}},d=l?(0,a.eI)(n,i,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:void 0},realtime:{params:{eventsPerSecond:10}}}):u(),m=l&&o?(0,a.eI)(n,o,{auth:{autoRefreshToken:!1,persistSession:!1}}):u(),c={USERS:"users",USER_PREFERENCES:"user_preferences",USER_STATS:"user_stats",POMODORO_SESSIONS:"pomodoro_sessions",MEETINGS:"meetings",AUTH_SESSIONS:"auth_sessions"}},2859:(e,t,r)=>{r.d(t,{Gc:()=>f,Hm:()=>m,Ij:()=>c,LW:()=>d,P:()=>R,Wr:()=>l,Xs:()=>p,bi:()=>h,kv:()=>_,y7:()=>u});let a=(e,t=null,r=null,a={})=>{let n={success:e,timestamp:new Date().toISOString(),...a};return e?(n.data=t,r&&(n.message=r)):(n.error=r||"An error occurred",t&&(n.details=t)),n},n=(e,t=null,r={})=>a(!0,e,t,r),i=(e,t=null,r={})=>a(!1,t,e,r),o={OK:200,UNAUTHORIZED:401,FORBIDDEN:403,NOT_FOUND:404,CONFLICT:409,UNPROCESSABLE_ENTITY:422,INTERNAL_SERVER_ERROR:500},s=(e,t,r)=>Response.json(r,{status:t}),l=(e,t,r=null,a=o.OK,i={})=>s(e,a,n(t,r,i)),u=(e,t,r=o.INTERNAL_SERVER_ERROR,a=null,n={})=>s(e,r,i(t,a,n)),d=(e,t="Unauthorized")=>u(e,t,o.UNAUTHORIZED),m=(e,t="Forbidden")=>u(e,t,o.FORBIDDEN),c=(e,t="Resource not found")=>u(e,t,o.NOT_FOUND),p=(e,t="Resource conflict",r=null)=>u(e,t,o.CONFLICT,r),f=(e,t,r="Validation failed")=>u(e,r,o.UNPROCESSABLE_ENTITY,t),g=(e,t="Internal server error",r=null)=>(r&&console.error("Internal server error:",r),u(e,t,o.INTERNAL_SERVER_ERROR)),h=e=>async(t,r)=>{try{await e(t,r)}catch(e){if(console.error("API route error:",e),"ValidationError"===e.name)return f(r,e.errors,e.message);if("UnauthorizedError"===e.name)return d(r,e.message);if("ForbiddenError"===e.name)return m(r,e.message);if("NotFoundError"===e.name)return c(r,e.message);if("ConflictError"===e.name)return p(r,e.message,e.details);return g(r,"An unexpected error occurred",e)}},_=(e,t,r)=>{let a=Math.ceil(r/t);return{pagination:{currentPage:e,totalPages:a,totalCount:r,limit:t,hasNextPage:e<a,hasPrevPage:e>1}}},R=(e,t,r)=>!!r.includes(e.method)||(t.setHeader("Allow",r.join(", ")),u(t,`Method ${e.method} not allowed`,405))},7246:(e,t,r)=>{r.d(t,{$p:()=>R,CG:()=>S,Db:()=>g,Fv:()=>E,Mk:()=>f,Vp:()=>c,W0:()=>x,bd:()=>_,dm:()=>m,g2:()=>y,gY:()=>d,sQ:()=>h,xH:()=>p});var a=r(1598),n=r(7254),i=r(9489);let o=a.Z_().email("Invalid email address").toLowerCase(),s=a.Z_().min(4,"Password must be at least 4 characters"),l=a.Z_().min(1,"Username is required").max(50,"Username too long");a.Z_().uuid("Invalid UUID format"),a.Rx().int().positive();let u=a.Z_().datetime("Invalid date format"),d=a.Ry({username:l,email:o,password:s,displayName:a.Z_().max(100).optional()}),m=a.Ry({username:l,password:a.Z_().min(1,"Password is required"),rememberMe:a.O7().default(!1)}),c=(a.Ry({currentPassword:a.Z_().min(1,"Current password is required"),newPassword:s}),a.Ry({displayName:a.Z_().max(100).optional(),email:o.optional(),bio:a.Z_().max(500).optional(),avatar:a.Z_().url().optional().or(a.i0(""))})),p=a.Ry({defaultPomodoroLength:a.Rx().int().min(1).max(120).default(25),breakLength:a.Rx().int().min(1).max(30).default(5),longBreakLength:a.Rx().int().min(1).max(60).default(15),weeklyGoal:a.Rx().int().min(1).max(1e3).default(140),theme:a.Km(["default","dark","minimal"]).default("default"),soundEnabled:a.O7().default(!0),notificationsEnabled:a.O7().default(!0),autoStartBreak:a.O7().default(!1),autoStartPomodoro:a.O7().default(!1)}),f=a.Ry({title:a.Z_().min(1,"Session title is required").max(200),goal:a.Z_().max(500).optional(),tags:a.Z_().max(200).optional(),location:a.Z_().max(100).optional(),duration:a.Rx().int().min(1).max(120).default(25),scheduledTime:u.optional()}),g=a.Ry({title:a.Z_().min(1).max(200).optional(),goal:a.Z_().max(500).optional(),tags:a.Z_().max(200).optional(),location:a.Z_().max(100).optional(),status:a.Km(["scheduled","active","completed","stopped"]).optional()}),h=a.Ry({page:n.Rx().int().min(1).default(1),limit:n.Rx().int().min(1).max(100).default(20),status:a.Km(["scheduled","active","completed","stopped"]).optional(),startDate:a.Z_().date().optional(),endDate:a.Z_().date().optional(),tags:a.Z_().optional()}),_=a.Ry({title:a.Z_().min(1,"Meeting title is required").max(200),description:a.Z_().max(1e3).optional(),date:a.Z_().date("Invalid date format"),time:a.Z_().regex(/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/,"Invalid time format (HH:MM)"),duration:a.Rx().int().min(15).max(480).default(60),location:a.Z_().max(200).optional(),participants:a.IX(a.Z_().email()).optional(),type:a.Km(["meeting","call","presentation","workshop","other"]).default("meeting"),priority:a.Km(["low","medium","high"]).default("medium"),reminderMinutes:a.Rx().int().min(0).max(10080).default(15)}),R=_.partial(),S=a.Ry({date:a.Z_().date().optional(),startDate:a.Z_().date().optional(),endDate:a.Z_().date().optional(),type:a.Km(["meeting","call","presentation","workshop","other"]).optional(),priority:a.Km(["low","medium","high"]).optional()}),y=a.Ry({period:a.Km(["day","week","month","year"]).default("week"),startDate:a.Z_().date().optional(),endDate:a.Z_().date().optional()}),x=a.Ry({period:a.Km(["week","month","year"]).default("week"),limit:n.Rx().int().min(1).max(100).default(10)}),E=(a.Ry({page:n.Rx().int().min(1).default(1),limit:n.Rx().int().min(1).max(100).default(20)}),a.Ry({sortBy:a.Z_().optional(),sortOrder:a.Km(["asc","desc"]).default("desc")}),(e,t)=>{try{return{success:!0,data:e.parse(t),errors:null}}catch(e){if(e instanceof i.j)return{success:!1,data:null,errors:(e.errors||[]).map(e=>({field:e.path?.join(".")||"unknown",message:e.message,code:e.code}))};return{success:!1,data:null,errors:[{message:"Validation failed",code:"unknown_error"}]}}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[948,766,254],()=>r(7189));module.exports=a})();