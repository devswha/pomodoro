(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[401],{7151:function(e,n,t){Promise.resolve().then(t.bind(t,2586))},9376:function(e,n,t){"use strict";var r=t(5475);t.o(r,"usePathname")&&t.d(n,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(n,{useRouter:function(){return r.useRouter}})},2586:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var r=t(7437),s=t(2265),i=t(9376),o=t(3954),c=t(1968);let a=o.ZP.div.withConfig({componentId:"sc-17d2798a-0"})(["padding:2rem;"]),u=o.ZP.div.withConfig({componentId:"sc-17d2798a-1"})(["display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:2px solid #e9ecef;"]),l=o.ZP.h1.withConfig({componentId:"sc-17d2798a-2"})(["font-size:2rem;font-weight:700;color:#000000;margin:0;"]),d=o.ZP.button.withConfig({componentId:"sc-17d2798a-3"})(["background:#ffffff;border:2px solid #000000;color:#000000;padding:0.75rem 1.5rem;font-size:0.875rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;cursor:pointer;transition:all 0.2s ease;&:hover{background:#000000;color:#ffffff;}"]),f=o.ZP.div.withConfig({componentId:"sc-17d2798a-4"})(["display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem;margin-bottom:2rem;"]),h=o.ZP.div.withConfig({componentId:"sc-17d2798a-5"})(["background:#ffffff;border:2px solid #e9ecef;padding:1.5rem;"]),m=o.ZP.div.withConfig({componentId:"sc-17d2798a-6"})(["font-size:2.5rem;font-weight:700;color:#000000;margin-bottom:0.5rem;"]),g=o.ZP.div.withConfig({componentId:"sc-17d2798a-7"})(["font-size:0.875rem;color:#6c757d;text-transform:uppercase;letter-spacing:1px;"]),p=o.ZP.div.withConfig({componentId:"sc-17d2798a-8"})(["background:#ffffff;border:2px solid #e9ecef;padding:2rem;margin-bottom:2rem;"]),x=o.ZP.h3.withConfig({componentId:"sc-17d2798a-9"})(["font-size:1.25rem;font-weight:600;color:#000000;margin:0 0 1.5rem 0;text-transform:uppercase;letter-spacing:1px;"]),b=o.ZP.table.withConfig({componentId:"sc-17d2798a-10"})(["width:100%;border-collapse:collapse;background:#ffffff;border:2px solid #e9ecef;"]),S=o.ZP.th.withConfig({componentId:"sc-17d2798a-11"})(["background:#f8f9fa;border:1px solid #e9ecef;padding:1rem;text-align:left;font-weight:600;text-transform:uppercase;letter-spacing:1px;font-size:0.875rem;"]),j=o.ZP.td.withConfig({componentId:"sc-17d2798a-12"})(["border:1px solid #e9ecef;padding:1rem;"]),v=o.ZP.tr.withConfig({componentId:"sc-17d2798a-13"})(["&:hover{background:#f8f9fa;}"]),I=o.ZP.div.withConfig({componentId:"sc-17d2798a-14"})(["display:flex;justify-content:center;align-items:center;height:400px;font-size:1rem;color:#6c757d;"]),w=o.ZP.div.withConfig({componentId:"sc-17d2798a-15"})(["background:#e9ecef;height:20px;position:relative;overflow:hidden;"]),P=o.ZP.div.withConfig({componentId:"sc-17d2798a-16"})(["background:#000000;height:100%;width:","%;transition:width 0.3s ease;"],e=>e.percent);function C(){let e=(0,i.useRouter)(),[n,t]=(0,s.useState)(!0),[o,C]=(0,s.useState)({totalSessions:0,completedSessions:0,totalMinutes:0,averageSessionLength:0,completionRate:0,topUsers:[]});(0,s.useEffect)(()=>{if("true"!==sessionStorage.getItem("adminAuthenticated")){e.push("/admin");return}y()},[]);let y=async()=>{try{t(!0);let{data:e,error:n}=await c.OQ.from("pomodoro_sessions").select("*");if(n)throw n;let{data:r,error:s}=await c.OQ.from("pomodoro_sessions").select("user_id, users(username, display_name)").eq("status","completed");if(s)throw s;let i=(null==e?void 0:e.length)||0,o=(null==e?void 0:e.filter(e=>"completed"===e.status).length)||0,a=(null==e?void 0:e.reduce((e,n)=>e+(n.duration||0),0))||0,u={};null==r||r.forEach(e=>{let n=e.user_id;if(!u[n]){var t,r;u[n]={userId:n,username:(null===(t=e.users)||void 0===t?void 0:t.username)||"Unknown",displayName:(null===(r=e.users)||void 0===r?void 0:r.display_name)||"Unknown",count:0}}u[n].count++});let l=Object.values(u).sort((e,n)=>n.count-e.count).slice(0,10);C({totalSessions:i,completedSessions:o,totalMinutes:a,averageSessionLength:i>0?Math.round(a/i):0,completionRate:i>0?Math.round(o/i*100):0,topUsers:l})}catch(e){console.error("Error fetching analytics:",e)}finally{t(!1)}};return n?(0,r.jsx)(a,{children:(0,r.jsx)(I,{children:"Loading analytics..."})}):(0,r.jsxs)(a,{children:[(0,r.jsxs)(u,{children:[(0,r.jsx)(l,{children:"통계 및 분석"}),(0,r.jsx)(d,{onClick:()=>e.push("/admin"),children:"← 돌아가기"})]}),(0,r.jsxs)(f,{children:[(0,r.jsxs)(h,{children:[(0,r.jsx)(m,{children:o.totalSessions}),(0,r.jsx)(g,{children:"전체 세션"})]}),(0,r.jsxs)(h,{children:[(0,r.jsx)(m,{children:o.completedSessions}),(0,r.jsx)(g,{children:"완료된 세션"})]}),(0,r.jsxs)(h,{children:[(0,r.jsxs)(m,{children:[o.totalMinutes,"분"]}),(0,r.jsx)(g,{children:"총 누적 시간"})]}),(0,r.jsxs)(h,{children:[(0,r.jsxs)(m,{children:[o.averageSessionLength,"분"]}),(0,r.jsx)(g,{children:"평균 세션 길이"})]})]}),(0,r.jsxs)(p,{children:[(0,r.jsx)(x,{children:"세션 완료율"}),(0,r.jsx)(w,{children:(0,r.jsx)(P,{percent:o.completionRate})}),(0,r.jsxs)("div",{style:{marginTop:"0.5rem",textAlign:"center",fontWeight:"bold"},children:[o.completionRate,"%"]})]}),(0,r.jsxs)(p,{children:[(0,r.jsx)(x,{children:"상위 사용자 (완료 세션 기준)"}),(0,r.jsxs)(b,{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)(S,{children:"순위"}),(0,r.jsx)(S,{children:"사용자"}),(0,r.jsx)(S,{children:"이름"}),(0,r.jsx)(S,{children:"완료 세션"})]})}),(0,r.jsx)("tbody",{children:o.topUsers.map((e,n)=>(0,r.jsxs)(v,{children:[(0,r.jsx)(j,{children:n+1}),(0,r.jsx)(j,{children:e.username}),(0,r.jsx)(j,{children:e.displayName}),(0,r.jsx)(j,{children:e.count})]},e.userId))})]}),0===o.topUsers.length&&(0,r.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#6c757d"},children:"데이터가 없습니다"})]})]})}},1968:function(e,n,t){"use strict";t.d(n,{OQ:function(){return d},ji:function(){return f}});var r=t(8439),s=t(257);let i="https://lasoynzegoiktncjzqad.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxhc295bnplZ29pa3RuY2p6cWFkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxNzkwMTEsImV4cCI6MjA3Mzc1NTAxMX0.zHQX-LwBBqE3S2xpQW38ZqNbHlqKHnxCKuFX8IEhM2k",c=s.env.SUPABASE_SERVICE_ROLE_KEY,a=e=>{if(!e||e.includes("your_supabase")||e.includes("placeholder")||e.includes("demo.supabase.co"))return!1;try{return new URL(e),e.includes("supabase.co")}catch(e){return!1}},u=a(i)&&o&&!o.includes("your_");console.log("Supabase Configuration Status:",{url:i?"Present":"Missing",urlValid:a(i),anonKey:o?"Present":"Missing",anonKeyValid:o&&!o.includes("your_"),hasValidConfig:u});let l=()=>{let e={select:function(){return this},insert:function(){return this},update:function(){return this},delete:function(){return this},eq:function(){return this},neq:function(){return this},gt:function(){return this},gte:function(){return this},lt:function(){return this},lte:function(){return this},like:function(){return this},ilike:function(){return this},is:function(){return this},in:function(){return this},contains:function(){return this},containedBy:function(){return this},rangeGt:function(){return this},rangeGte:function(){return this},rangeLt:function(){return this},rangeLte:function(){return this},rangeAdjacent:function(){return this},overlaps:function(){return this},textSearch:function(){return this},match:function(){return this},not:function(){return this},or:function(){return this},filter:function(){return this},order:function(){return this},limit:function(){return this},range:function(){return this},abortSignal:function(){return this},single:function(){return Promise.resolve({data:null,error:{message:"Using localStorage mode - no data available"}})},maybeSingle:function(){return Promise.resolve({data:null,error:null})},then:function(e){return e({data:[],error:null})},catch:function(){return this}};return{from:()=>e,auth:{signUp:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signInWithPassword:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signOut:()=>Promise.resolve({error:null}),getUser:()=>Promise.resolve({data:{user:null},error:{message:"Using localStorage mode"}}),getSession:()=>Promise.resolve({data:{session:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},channel:()=>({on:function(){return this},subscribe:()=>Promise.resolve("SUBSCRIBED"),unsubscribe:()=>{},track:()=>Promise.resolve(),send:()=>Promise.resolve(),presenceState:()=>({})}),realtime:{disconnect:()=>{}}}},d=u?(0,r.eI)(i,o,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:window.localStorage},realtime:{params:{eventsPerSecond:10}}}):l();u&&c?(0,r.eI)(i,c,{auth:{autoRefreshToken:!1,persistSession:!1}}):l();let f={USERS:"users",USER_PREFERENCES:"user_preferences",USER_STATS:"user_stats",POMODORO_SESSIONS:"pomodoro_sessions",MEETINGS:"meetings",AUTH_SESSIONS:"auth_sessions"}}},function(e){e.O(0,[954,439,971,966,744],function(){return e(e.s=7151)}),_N_E=e.O()}]);