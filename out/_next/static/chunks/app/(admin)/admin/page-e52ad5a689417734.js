(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{8195:function(e,o,n){Promise.resolve().then(n.bind(n,4126))},9376:function(e,o,n){"use strict";var i=n(5475);n.o(i,"usePathname")&&n.d(o,{usePathname:function(){return i.usePathname}}),n.o(i,"useRouter")&&n.d(o,{useRouter:function(){return i.useRouter}})},4126:function(e,o,n){"use strict";n.r(o),n.d(o,{default:function(){return B}});var i=n(7437),t=n(2265),s=n(9376),r=n(3954),c=n(419);let a=r.ZP.div.withConfig({componentId:"sc-a72cd40-0"})(["display:flex;flex-direction:column;gap:2rem;"]),d=r.ZP.div.withConfig({componentId:"sc-a72cd40-1"})(["background:#ffffff;border:2px solid #e9ecef;padding:2rem;"]),l=r.ZP.h2.withConfig({componentId:"sc-a72cd40-2"})(["font-size:2rem;font-weight:700;color:#000000;margin:0 0 0.5rem 0;"]),f=r.ZP.p.withConfig({componentId:"sc-a72cd40-3"})(["font-size:1rem;color:#6c757d;margin:0;"]),m=r.ZP.div.withConfig({componentId:"sc-a72cd40-4"})(["display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem;"]),p=r.ZP.div.withConfig({componentId:"sc-a72cd40-5"})(["background:#ffffff;border:2px solid #e9ecef;padding:1.5rem;transition:all 0.2s ease;cursor:pointer;&:hover{border-color:#000000;transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,0.1);}"]),h=r.ZP.div.withConfig({componentId:"sc-a72cd40-6"})(["font-size:2rem;margin-bottom:1rem;"]),u=r.ZP.div.withConfig({componentId:"sc-a72cd40-7"})(["font-size:2.5rem;font-weight:700;color:#000000;margin-bottom:0.5rem;"]),g=r.ZP.div.withConfig({componentId:"sc-a72cd40-8"})(["font-size:0.875rem;color:#6c757d;text-transform:uppercase;letter-spacing:1px;"]),x=r.ZP.div.withConfig({componentId:"sc-a72cd40-9"})(["font-size:0.875rem;color:",";margin-top:0.5rem;"],e=>e.positive?"#28a745":"#dc3545"),j=r.ZP.div.withConfig({componentId:"sc-a72cd40-10"})(["background:#ffffff;border:2px solid #e9ecef;padding:2rem;"]),w=r.ZP.h3.withConfig({componentId:"sc-a72cd40-11"})(["font-size:1.25rem;font-weight:600;color:#000000;margin:0 0 1.5rem 0;text-transform:uppercase;letter-spacing:1px;"]),b=r.ZP.div.withConfig({componentId:"sc-a72cd40-12"})(["display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;"]),v=r.ZP.button.withConfig({componentId:"sc-a72cd40-13"})(["background:#f8f9fa;border:2px solid #e9ecef;padding:1rem;font-size:0.875rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;cursor:pointer;transition:all 0.2s ease;display:flex;flex-direction:column;align-items:center;gap:0.5rem;&:hover{background:#000000;color:#ffffff;border-color:#000000;}&:disabled{opacity:0.5;cursor:not-allowed;}"]),C=r.ZP.span.withConfig({componentId:"sc-a72cd40-14"})(["font-size:1.5rem;"]),k=r.ZP.div.withConfig({componentId:"sc-a72cd40-15"})(["background:#ffffff;border:2px solid #e9ecef;padding:2rem;"]),I=r.ZP.div.withConfig({componentId:"sc-a72cd40-16"})(["display:flex;flex-direction:column;gap:1rem;max-height:400px;overflow-y:auto;"]),P=r.ZP.div.withConfig({componentId:"sc-a72cd40-17"})(["display:flex;align-items:center;gap:1rem;padding:1rem;background:#f8f9fa;border:1px solid #e9ecef;"]),y=r.ZP.div.withConfig({componentId:"sc-a72cd40-18"})(["font-size:1.25rem;"]),Z=r.ZP.div.withConfig({componentId:"sc-a72cd40-19"})(["flex:1;"]),D=r.ZP.div.withConfig({componentId:"sc-a72cd40-20"})(["font-size:0.875rem;color:#000000;margin-bottom:0.25rem;"]),S=r.ZP.div.withConfig({componentId:"sc-a72cd40-21"})(["font-size:0.75rem;color:#6c757d;"]),z=r.ZP.div.withConfig({componentId:"sc-a72cd40-22"})(["display:flex;justify-content:center;align-items:center;height:400px;font-size:1rem;color:#6c757d;"]),T=r.ZP.div.withConfig({componentId:"sc-a72cd40-23"})(["background:#f8d7da;border:1px solid #f5c6cb;color:#721c24;padding:1rem;margin-bottom:2rem;"]),E=r.ZP.div.withConfig({componentId:"sc-a72cd40-24"})(["display:flex;justify-content:center;align-items:center;min-height:100vh;padding:2rem;"]),U=r.ZP.div.withConfig({componentId:"sc-a72cd40-25"})(["background:#ffffff;border:2px solid #000000;padding:3rem;width:100%;max-width:400px;"]),R=r.ZP.h2.withConfig({componentId:"sc-a72cd40-26"})(["font-size:2rem;font-weight:700;color:#000000;margin:0 0 0.5rem 0;text-align:center;"]),A=r.ZP.p.withConfig({componentId:"sc-a72cd40-27"})(["font-size:0.875rem;color:#6c757d;margin:0 0 2rem 0;text-align:center;"]),N=r.ZP.form.withConfig({componentId:"sc-a72cd40-28"})(["display:flex;flex-direction:column;gap:1rem;"]),O=r.ZP.input.withConfig({componentId:"sc-a72cd40-29"})(["border:2px solid #e9ecef;padding:1rem;font-size:1rem;background:#ffffff;color:#000000;outline:none;transition:border-color 0.2s ease;&:focus{border-color:#000000;}&::placeholder{color:#adb5bd;}"]),L=r.ZP.button.withConfig({componentId:"sc-a72cd40-30"})(["background:#000000;border:2px solid #000000;color:#ffffff;padding:1rem;font-size:1rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;cursor:pointer;transition:all 0.2s ease;&:hover{background:#333333;border-color:#333333;}&:active{transform:translateY(2px);}"]),_=r.ZP.div.withConfig({componentId:"sc-a72cd40-31"})(["background:#f8d7da;border:1px solid #f5c6cb;color:#721c24;padding:0.75rem;font-size:0.875rem;text-align:center;"]);function B(){let e=(0,s.useRouter)(),{currentUser:o,authLoading:n}=(0,c.a)(),[r,B]=(0,t.useState)(!0),[F,G]=(0,t.useState)({totalUsers:0,activeUsers:0,totalSessions:0,newUsersToday:0,activeSessionsNow:0,completionRate:0}),[H,Y]=(0,t.useState)([]),[Q,W]=(0,t.useState)(""),[q,J]=(0,t.useState)(!1),[K,M]=(0,t.useState)(""),[V,X]=(0,t.useState)("");(0,t.useEffect)(()=>{"true"===sessionStorage.getItem("adminAuthenticated")&&(J(!0),$())},[]);let $=async()=>{try{B(!0);let e=localStorage.getItem("userToken")||sessionStorage.getItem("userToken"),o=await fetch("/api/admin/dashboard",{method:"GET",headers:{"Content-Type":"application/json","x-user-token":e||""}});if(!o.ok)throw Error("HTTP error! status: ".concat(o.status));let n=await o.json();if(n.success)G(n.stats),Y(n.recentActivities);else throw Error(n.error||"Failed to load dashboard data")}catch(e){console.error("Error fetching dashboard data:",e),W("Failed to load dashboard data")}finally{B(!1)}},ee=o=>{e.push(o)},eo=async e=>{switch(e){case"export-users":let o=localStorage.getItem("userToken")||sessionStorage.getItem("userToken"),n=await fetch("/api/admin/export-users",{method:"GET",headers:{"Content-Type":"application/json","x-user-token":o||""}});if(n.ok){let e=await n.json();e.success&&e.users&&ei(en(e.users),"users-export.csv")}break;case"backup-data":alert("Backup initiated. This feature is coming soon.");break;case"clear-sessions":window.confirm("Are you sure you want to clear all inactive sessions?")&&alert("Clear sessions feature is temporarily disabled");break;case"send-notification":alert("Notification feature coming soon")}},en=e=>[Object.keys(e[0]).join(","),...e.map(e=>Object.values(e).join(","))].join("\n"),ei=(e,o)=>{let n=new Blob([e],{type:"text/csv"}),i=window.URL.createObjectURL(n),t=document.createElement("a");t.href=i,t.download=o,t.click(),window.URL.revokeObjectURL(i)};return q?r?(0,i.jsx)(a,{children:(0,i.jsx)(z,{children:"Loading dashboard..."})}):Q?(0,i.jsx)(a,{children:(0,i.jsx)(T,{children:Q})}):(0,i.jsxs)(a,{children:[(0,i.jsxs)(d,{children:[(0,i.jsx)(l,{children:"Welcome, Admin!"}),(0,i.jsx)(f,{children:"Here's an overview of your STEP Timer application"})]}),(0,i.jsxs)(m,{children:[(0,i.jsxs)(p,{onClick:()=>ee("/admin/users"),children:[(0,i.jsx)(h,{children:"\uD83D\uDC65"}),(0,i.jsx)(u,{children:F.totalUsers}),(0,i.jsx)(g,{children:"Total Users"}),(0,i.jsxs)(x,{positive:F.newUsersToday>0,children:["+",F.newUsersToday," today"]})]}),(0,i.jsxs)(p,{onClick:()=>ee("/admin/users"),children:[(0,i.jsx)(h,{children:"\uD83D\uDFE2"}),(0,i.jsx)(u,{children:F.activeUsers}),(0,i.jsx)(g,{children:"Active Users"}),(0,i.jsx)(x,{positive:!0,children:"Last 7 days"})]}),(0,i.jsxs)(p,{onClick:()=>ee("/admin/analytics"),children:[(0,i.jsx)(h,{children:"⏰"}),(0,i.jsx)(u,{children:F.totalSessions}),(0,i.jsx)(g,{children:"Total Sessions"}),(0,i.jsxs)(x,{positive:F.activeSessionsNow>0,children:[F.activeSessionsNow," active now"]})]}),(0,i.jsxs)(p,{onClick:()=>ee("/admin/analytics"),children:[(0,i.jsx)(h,{children:"\uD83D\uDCCA"}),(0,i.jsxs)(u,{children:[F.completionRate,"%"]}),(0,i.jsx)(g,{children:"Completion Rate"}),(0,i.jsx)(x,{positive:F.completionRate>=70,children:"Overall"})]})]}),(0,i.jsxs)(j,{children:[(0,i.jsx)(w,{children:"Quick Actions"}),(0,i.jsxs)(b,{children:[(0,i.jsxs)(v,{onClick:()=>eo("export-users"),children:[(0,i.jsx)(C,{children:"\uD83D\uDCE5"}),"Export Users"]}),(0,i.jsxs)(v,{onClick:()=>eo("backup-data"),children:[(0,i.jsx)(C,{children:"\uD83D\uDCBE"}),"Backup Data"]}),(0,i.jsxs)(v,{onClick:()=>eo("clear-sessions"),children:[(0,i.jsx)(C,{children:"\uD83D\uDDD1️"}),"Clear Old Sessions"]}),(0,i.jsxs)(v,{onClick:()=>eo("send-notification"),children:[(0,i.jsx)(C,{children:"\uD83D\uDCE2"}),"Send Notification"]})]})]}),(0,i.jsxs)(k,{children:[(0,i.jsx)(w,{children:"Recent Activity"}),(0,i.jsx)(I,{children:H.length>0?H.map(e=>(0,i.jsxs)(P,{children:[(0,i.jsx)(y,{children:e.icon}),(0,i.jsxs)(Z,{children:[(0,i.jsx)(D,{children:e.text}),(0,i.jsx)(S,{children:e.time})]})]},e.id)):(0,i.jsx)(P,{children:(0,i.jsx)(Z,{children:(0,i.jsx)(D,{children:"No recent activity"})})})})]})]}):(0,i.jsx)(E,{children:(0,i.jsxs)(U,{children:[(0,i.jsx)(R,{children:"관리자 인증"}),(0,i.jsx)(A,{children:"관리자 페이지에 접근하려면 비밀번호를 입력하세요"}),(0,i.jsxs)(N,{onSubmit:e=>{e.preventDefault(),"admin123"===K?(J(!0),sessionStorage.setItem("adminAuthenticated","true"),X(""),$()):(X("비밀번호가 올바르지 않습니다"),M(""))},children:[V&&(0,i.jsx)(_,{children:V}),(0,i.jsx)(O,{type:"password",placeholder:"비밀번호 입력",value:K,onChange:e=>M(e.target.value),autoFocus:!0}),(0,i.jsx)(L,{type:"submit",children:"확인"})]})]})})}}},function(e){e.O(0,[954,439,81,419,971,966,744],function(){return e(e.s=8195)}),_N_E=e.O()}]);