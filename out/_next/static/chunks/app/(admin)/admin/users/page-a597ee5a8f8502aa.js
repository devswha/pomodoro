(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{3590:function(e,n,t){Promise.resolve().then(t.bind(t,2968))},9376:function(e,n,t){"use strict";var r=t(5475);t.o(r,"usePathname")&&t.d(n,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(n,{useRouter:function(){return r.useRouter}})},2968:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var r=t(7437),o=t(2265),i=t(9376),s=t(3954),c=t(1968);let a=s.ZP.div.withConfig({componentId:"sc-8e69c669-0"})(["padding:2rem;"]),l=s.ZP.div.withConfig({componentId:"sc-8e69c669-1"})(["display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:2px solid #e9ecef;"]),u=s.ZP.h1.withConfig({componentId:"sc-8e69c669-2"})(["font-size:2rem;font-weight:700;color:#000000;margin:0;"]),d=s.ZP.button.withConfig({componentId:"sc-8e69c669-3"})(["background:#ffffff;border:2px solid #000000;color:#000000;padding:0.75rem 1.5rem;font-size:0.875rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;cursor:pointer;transition:all 0.2s ease;&:hover{background:#000000;color:#ffffff;}"]),f=s.ZP.input.withConfig({componentId:"sc-8e69c669-4"})(["border:2px solid #e9ecef;padding:0.75rem 1rem;font-size:1rem;width:100%;max-width:400px;margin-bottom:1.5rem;&:focus{outline:none;border-color:#000000;}"]),h=s.ZP.table.withConfig({componentId:"sc-8e69c669-5"})(["width:100%;border-collapse:collapse;background:#ffffff;border:2px solid #e9ecef;"]),m=s.ZP.th.withConfig({componentId:"sc-8e69c669-6"})(["background:#f8f9fa;border:1px solid #e9ecef;padding:1rem;text-align:left;font-weight:600;text-transform:uppercase;letter-spacing:1px;font-size:0.875rem;"]),g=s.ZP.td.withConfig({componentId:"sc-8e69c669-7"})(["border:1px solid #e9ecef;padding:1rem;"]),p=s.ZP.tr.withConfig({componentId:"sc-8e69c669-8"})(["&:hover{background:#f8f9fa;}"]),x=s.ZP.span.withConfig({componentId:"sc-8e69c669-9"})(["background:",";color:#ffffff;padding:0.25rem 0.5rem;font-size:0.75rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;"],e=>e.active?"#28a745":"#6c757d"),b=s.ZP.button.withConfig({componentId:"sc-8e69c669-10"})(["background:#dc3545;color:#ffffff;border:none;padding:0.5rem 1rem;font-size:0.875rem;font-weight:600;cursor:pointer;transition:all 0.2s ease;&:hover{background:#c82333;}&:disabled{background:#6c757d;cursor:not-allowed;}"]),w=s.ZP.div.withConfig({componentId:"sc-8e69c669-11"})(["display:",";position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);justify-content:center;align-items:center;"],e=>e.show?"flex":"none"),j=s.ZP.div.withConfig({componentId:"sc-8e69c669-12"})(["background-color:#ffffff;padding:2rem;border:2px solid #000000;width:90%;max-width:500px;"]),S=s.ZP.h2.withConfig({componentId:"sc-8e69c669-13"})(["margin-top:0;margin-bottom:1rem;font-size:1.5rem;"]),v=s.ZP.p.withConfig({componentId:"sc-8e69c669-14"})(["margin-bottom:1.5rem;font-size:1rem;line-height:1.5;"]),I=s.ZP.div.withConfig({componentId:"sc-8e69c669-15"})(["display:flex;gap:1rem;justify-content:flex-end;"]),C=s.ZP.button.withConfig({componentId:"sc-8e69c669-16"})(["padding:0.75rem 1.5rem;font-size:0.875rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;cursor:pointer;transition:all 0.2s ease;border:2px solid #000000;&.confirm{background:#dc3545;color:#ffffff;border-color:#dc3545;&:hover{background:#c82333;border-color:#c82333;}}&.cancel{background:#ffffff;color:#000000;&:hover{background:#f8f9fa;}}"]),P=s.ZP.div.withConfig({componentId:"sc-8e69c669-17"})(["display:flex;justify-content:center;align-items:center;height:400px;font-size:1rem;color:#6c757d;"]);function k(){var e;let n=(0,i.useRouter)(),[t,s]=(0,o.useState)([]),[k,y]=(0,o.useState)([]),[E,_]=(0,o.useState)(!0),[Z,z]=(0,o.useState)(""),[R,L]=(0,o.useState)({show:!1,user:null}),[O,U]=(0,o.useState)(!1);(0,o.useEffect)(()=>{if("true"!==sessionStorage.getItem("adminAuthenticated")){n.push("/admin");return}N()},[]),(0,o.useEffect)(()=>{Z?y(t.filter(e=>{var n,t,r;return(null===(n=e.username)||void 0===n?void 0:n.toLowerCase().includes(Z.toLowerCase()))||(null===(t=e.display_name)||void 0===t?void 0:t.toLowerCase().includes(Z.toLowerCase()))||(null===(r=e.email)||void 0===r?void 0:r.toLowerCase().includes(Z.toLowerCase()))})):y(t)},[Z,t]);let N=async()=>{try{_(!0);let{data:e,error:n}=await c.OQ.from("users").select("*").order("created_at",{ascending:!1});if(n)throw n;s(e||[]),y(e||[])}catch(e){console.error("Error fetching users:",e)}finally{_(!1)}},T=e=>e?new Date(e).toLocaleDateString("ko-KR"):"-",A=e=>{if(!e)return!1;let n=new Date(Date.now()-6048e5);return new Date(e)>n},M=e=>{L({show:!0,user:e})},D=async()=>{if(R.user){U(!0);try{let e=await fetch("/api/users/delete?id=".concat(R.user.id),{method:"DELETE",headers:{"Content-Type":"application/json","x-admin-auth":"true"}}),n=await e.json();e.ok&&n.success?(s(t.filter(e=>e.id!==R.user.id)),y(k.filter(e=>e.id!==R.user.id)),L({show:!1,user:null}),alert("사용자가 성공적으로 삭제되었습니다.")):alert("삭제 실패: ".concat(n.message||"알 수 없는 오류"))}catch(e){console.error("Error deleting user:",e),alert("사용자 삭제 중 오류가 발생했습니다.")}finally{U(!1)}}};return E?(0,r.jsx)(a,{children:(0,r.jsx)(P,{children:"Loading users..."})}):(0,r.jsxs)(a,{children:[(0,r.jsxs)(l,{children:[(0,r.jsx)(u,{children:"사용자 관리"}),(0,r.jsx)(d,{onClick:()=>n.push("/admin"),children:"← 돌아가기"})]}),(0,r.jsx)(f,{type:"text",placeholder:"사용자 검색 (아이디, 이름, 이메일)",value:Z,onChange:e=>z(e.target.value)}),(0,r.jsxs)(h,{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)(m,{children:"아이디"}),(0,r.jsx)(m,{children:"이름"}),(0,r.jsx)(m,{children:"이메일"}),(0,r.jsx)(m,{children:"가입일"}),(0,r.jsx)(m,{children:"마지막 로그인"}),(0,r.jsx)(m,{children:"상태"}),(0,r.jsx)(m,{children:"작업"})]})}),(0,r.jsx)("tbody",{children:k.map(e=>(0,r.jsxs)(p,{children:[(0,r.jsx)(g,{children:e.username}),(0,r.jsx)(g,{children:e.display_name||"-"}),(0,r.jsx)(g,{children:e.email||"-"}),(0,r.jsx)(g,{children:T(e.created_at)}),(0,r.jsx)(g,{children:T(e.last_login)}),(0,r.jsx)(g,{children:(0,r.jsx)(x,{active:A(e.last_login),children:A(e.last_login)?"활성":"비활성"})}),(0,r.jsx)(g,{children:(0,r.jsx)(b,{onClick:()=>M(e),disabled:O,children:"삭제"})})]},e.id))})]}),0===k.length&&(0,r.jsx)("div",{style:{textAlign:"center",padding:"2rem",color:"#6c757d"},children:"검색 결과가 없습니다"}),(0,r.jsx)(w,{show:R.show,children:(0,r.jsxs)(j,{children:[(0,r.jsx)(S,{children:"사용자 삭제 확인"}),(0,r.jsxs)(v,{children:["정말로 사용자 ",(0,r.jsx)("strong",{children:null===(e=R.user)||void 0===e?void 0:e.username}),"님을 삭제하시겠습니까?",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"이 작업은 되돌릴 수 없으며, 해당 사용자의 모든 데이터(포모도로 세션, 미팅 등)가 함께 삭제됩니다."]}),(0,r.jsxs)(I,{children:[(0,r.jsx)(C,{className:"cancel",onClick:()=>{L({show:!1,user:null})},disabled:O,children:"취소"}),(0,r.jsx)(C,{className:"confirm",onClick:D,disabled:O,children:O?"삭제 중...":"삭제"})]})]})})]})}},1968:function(e,n,t){"use strict";t.d(n,{OQ:function(){return d},ji:function(){return f}});var r=t(8439),o=t(257);let i="https://lasoynzegoiktncjzqad.supabase.co",s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxhc295bnplZ29pa3RuY2p6cWFkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxNzkwMTEsImV4cCI6MjA3Mzc1NTAxMX0.zHQX-LwBBqE3S2xpQW38ZqNbHlqKHnxCKuFX8IEhM2k",c=o.env.SUPABASE_SERVICE_ROLE_KEY,a=e=>{if(!e||e.includes("your_supabase")||e.includes("placeholder")||e.includes("demo.supabase.co"))return!1;try{return new URL(e),e.includes("supabase.co")}catch(e){return!1}},l=a(i)&&s&&!s.includes("your_");console.log("Supabase Configuration Status:",{url:i?"Present":"Missing",urlValid:a(i),anonKey:s?"Present":"Missing",anonKeyValid:s&&!s.includes("your_"),hasValidConfig:l});let u=()=>{let e={select:function(){return this},insert:function(){return this},update:function(){return this},delete:function(){return this},eq:function(){return this},neq:function(){return this},gt:function(){return this},gte:function(){return this},lt:function(){return this},lte:function(){return this},like:function(){return this},ilike:function(){return this},is:function(){return this},in:function(){return this},contains:function(){return this},containedBy:function(){return this},rangeGt:function(){return this},rangeGte:function(){return this},rangeLt:function(){return this},rangeLte:function(){return this},rangeAdjacent:function(){return this},overlaps:function(){return this},textSearch:function(){return this},match:function(){return this},not:function(){return this},or:function(){return this},filter:function(){return this},order:function(){return this},limit:function(){return this},range:function(){return this},abortSignal:function(){return this},single:function(){return Promise.resolve({data:null,error:{message:"Using localStorage mode - no data available"}})},maybeSingle:function(){return Promise.resolve({data:null,error:null})},then:function(e){return e({data:[],error:null})},catch:function(){return this}};return{from:()=>e,auth:{signUp:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signInWithPassword:()=>Promise.resolve({data:{user:null,session:null},error:{message:"Using localStorage mode"}}),signOut:()=>Promise.resolve({error:null}),getUser:()=>Promise.resolve({data:{user:null},error:{message:"Using localStorage mode"}}),getSession:()=>Promise.resolve({data:{session:null},error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},channel:()=>({on:function(){return this},subscribe:()=>Promise.resolve("SUBSCRIBED"),unsubscribe:()=>{},track:()=>Promise.resolve(),send:()=>Promise.resolve(),presenceState:()=>({})}),realtime:{disconnect:()=>{}}}},d=l?(0,r.eI)(i,s,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,storage:window.localStorage},realtime:{params:{eventsPerSecond:10}}}):u();l&&c?(0,r.eI)(i,c,{auth:{autoRefreshToken:!1,persistSession:!1}}):u();let f={USERS:"users",USER_PREFERENCES:"user_preferences",USER_STATS:"user_stats",POMODORO_SESSIONS:"pomodoro_sessions",MEETINGS:"meetings",AUTH_SESSIONS:"auth_sessions"}}},function(e){e.O(0,[954,439,971,966,744],function(){return e(e.s=3590)}),_N_E=e.O()}]);